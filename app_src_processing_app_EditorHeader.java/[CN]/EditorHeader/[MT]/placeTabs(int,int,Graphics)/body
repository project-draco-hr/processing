{
  Sketch sketch=editor.getSketch();
  int x=left;
  for (int i=0; i < sketch.getCodeCount(); i++) {
    SketchCode code=sketch.getCode(i);
    Tab tab=tabs[i];
    int pieceCount=2 + (tab.textWidth / PIECE_WIDTH);
    if (tab.textVisible == false) {
      pieceCount=4;
    }
    int pieceWidth=pieceCount * PIECE_WIDTH;
    int state=(code == sketch.getCurrentCode()) ? SELECTED : UNSELECTED;
    if (g != null) {
      g.drawImage(pieces[state][LEFT],x,0,null);
    }
    x+=PIECE_WIDTH;
    int contentLeft=x;
    tab.left=x;
    for (int j=0; j < pieceCount; j++) {
      if (g != null) {
        g.drawImage(pieces[state][MIDDLE],x,0,null);
      }
      x+=PIECE_WIDTH;
    }
    tab.right=x;
    if (tab.textVisible) {
      int textLeft=contentLeft + (pieceWidth - tab.textWidth) / 2;
      if (g != null) {
        g.setColor(textColor[state]);
        int baseline=(sizeH + fontAscent) / 2;
        g.drawString(tab.text,textLeft,baseline);
      }
    }
    if (g != null) {
      g.drawImage(pieces[state][RIGHT],x,0,null);
    }
    x+=PIECE_WIDTH - 1;
  }
  return x <= right;
}
