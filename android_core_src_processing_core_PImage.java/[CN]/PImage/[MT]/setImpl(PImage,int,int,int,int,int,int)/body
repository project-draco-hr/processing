{
  if (sourceImage.pixels == null) {
    sourceImage.loadPixels();
  }
  if (pixels == null) {
    if (!bitmap.isMutable()) {
      bitmap=bitmap.copy(Config.ARGB_8888,true);
    }
    int offset=sourceY * sourceImage.width + sourceX;
    bitmap.setPixels(sourceImage.pixels,offset,sourceImage.width,targetX,targetY,sourceWidth,sourceHeight);
  }
 else {
    int srcOffset=sourceY * sourceImage.width + sourceX;
    int dstOffset=targetY * width + targetX;
    for (int y=sourceY; y < sourceY + sourceHeight; y++) {
      System.arraycopy(sourceImage.pixels,srcOffset,pixels,dstOffset,sourceWidth);
      srcOffset+=sourceImage.width;
      dstOffset+=width;
    }
    updatePixelsImpl(targetX,targetY,sourceWidth,sourceHeight);
  }
}
