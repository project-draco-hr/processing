{
  if (glProgram == 0 || contextIsOutdated()) {
    context=pgl.getCurrentContext();
    glProgram=PGraphicsOpenGL.createGLSLProgramObject(context);
    boolean hasVert=false;
    if (vertexFilename != null) {
      hasVert=loadVertexShader(vertexFilename);
    }
 else     if (vertexURL != null) {
      hasVert=loadVertexShader(vertexURL);
    }
 else {
      PGraphics.showException("Vertex shader filenames and URLs are " + "both null!");
    }
    boolean hasFrag=false;
    if (fragmentFilename != null) {
      hasFrag=loadFragmentShader(fragmentFilename);
    }
 else     if (fragmentURL != null) {
      hasFrag=loadFragmentShader(fragmentURL);
    }
 else {
      PGraphics.showException("Fragment shader filenames and URLs are " + "both null!");
    }
    boolean vertRes=true;
    if (hasVert) {
      vertRes=compileVertexShader();
    }
    boolean fragRes=true;
    if (hasFrag) {
      fragRes=compileFragmentShader();
    }
    if (vertRes && fragRes) {
      if (hasVert) {
        pgl.attachShader(glProgram,glVertex);
      }
      if (hasFrag) {
        pgl.attachShader(glProgram,glFragment);
      }
      pgl.linkProgram(glProgram);
      pgl.getProgramiv(glProgram,PGL.LINK_STATUS,intBuffer);
      boolean linked=intBuffer.get(0) == 0 ? false : true;
      if (!linked) {
        PGraphics.showException("Cannot link shader program:\n" + pgl.getProgramInfoLog(glProgram));
      }
      pgl.validateProgram(glProgram);
      pgl.getProgramiv(glProgram,PGL.VALIDATE_STATUS,intBuffer);
      boolean validated=intBuffer.get(0) == 0 ? false : true;
      if (!validated) {
        PGraphics.showException("Cannot validate shader program:\n" + pgl.getProgramInfoLog(glProgram));
      }
    }
  }
}
