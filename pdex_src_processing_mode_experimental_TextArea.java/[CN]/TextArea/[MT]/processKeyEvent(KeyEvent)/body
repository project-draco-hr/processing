{
  if (evt.getKeyCode() == KeyEvent.VK_ESCAPE) {
    if (suggestion != null) {
      if (suggestion.isVisible()) {
        log("esc key");
        hideSuggestion();
        evt.consume();
        return;
      }
    }
  }
  if (evt.getKeyCode() == KeyEvent.VK_ENTER) {
    if (suggestion != null) {
      if (suggestion.isVisible()) {
        if (suggestion.insertSelection()) {
          hideSuggestion();
          evt.consume();
          return;
        }
      }
    }
  }
  if (evt.getID() == KeyEvent.KEY_PRESSED) {
switch (evt.getKeyCode()) {
case KeyEvent.VK_DOWN:
      if (suggestion != null)       if (suggestion.isVisible()) {
        suggestion.moveDown();
        return;
      }
    break;
case KeyEvent.VK_UP:
  if (suggestion != null)   if (suggestion.isVisible()) {
    suggestion.moveUp();
    return;
  }
break;
case KeyEvent.VK_BACK_SPACE:
log("BK Key");
break;
case KeyEvent.VK_SPACE:
if (suggestion != null) if (suggestion.isVisible()) {
log("Space bar, hide completion list");
suggestion.hide();
}
break;
default :
break;
}
}
super.processKeyEvent(evt);
if (evt.getID() == KeyEvent.KEY_TYPED) {
char keyChar=evt.getKeyChar();
if (keyChar == KeyEvent.VK_ENTER || keyChar == KeyEvent.VK_ESCAPE) {
return;
}
 else if (keyChar == KeyEvent.VK_TAB || keyChar == KeyEvent.CHAR_UNDEFINED) {
return;
}
final KeyEvent evt2=evt;
if (evt.isAltDown() || evt.isControlDown() || evt.isMetaDown()) {
if (ExperimentalMode.ccTriggerEnabled && keyChar == KeyEvent.VK_SPACE && (evt.isControlDown() || evt.isMetaDown())) {
SwingWorker worker=new SwingWorker(){
protected Object doInBackground() throws Exception {
if (ExperimentalMode.codeCompletionsEnabled && ExperimentalMode.ccTriggerEnabled) {
getDocument().remove(getCaretPosition() - 1,1);
log("[KeyEvent]" + evt2.getKeyChar() + "  |Prediction started: "+ System.currentTimeMillis());
log("Typing: " + fetchPhrase(evt2) + " "+ (evt2.getKeyChar() == KeyEvent.VK_ENTER)+ " T: "+ System.currentTimeMillis());
}
return null;
}
}
;
worker.execute();
}
return;
}
SwingWorker worker=new SwingWorker(){
protected Object doInBackground() throws Exception {
if (ExperimentalMode.codeCompletionsEnabled && (!ExperimentalMode.ccTriggerEnabled || suggestion.isVisible())) {
log("[KeyEvent]" + evt2.getKeyChar() + "  |Prediction started: "+ System.currentTimeMillis());
log("Typing: " + fetchPhrase(evt2) + " "+ (evt2.getKeyChar() == KeyEvent.VK_ENTER)+ " T: "+ System.currentTimeMillis());
}
return null;
}
}
;
worker.execute();
}
}
