{
  float startX=x;
  int index=0;
  char previous=0;
  int length=str.length();
  if (length > c.length) {
    c=new char[length + 10];
  }
  str.getChars(0,length,c,0);
  while (index < length) {
    if (c[index] == '\n') {
      x=startX;
      y+=leading;
      previous=0;
    }
 else {
      text(c[index],x,y,z,parent);
      x+=width(c[index]);
      if (previous != 0)       x+=kern(previous,c[index]);
      previous=c[index];
    }
    index++;
  }
}
