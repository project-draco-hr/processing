{
  float[] triColor=triangleColors[triIndex][colorIndex];
  float[] v=vertices[vIndex];
  triColor[TRI_DIFFUSE_R]=min(1,v[ER] + v[AR] * lightContribution[LIGHT_AMBIENT_R] + v[DR] * lightContribution[LIGHT_DIFFUSE_R]);
  triColor[TRI_DIFFUSE_G]=min(1,v[EG] + v[AG] * lightContribution[LIGHT_AMBIENT_G] + v[DG] * lightContribution[LIGHT_DIFFUSE_G]);
  triColor[TRI_DIFFUSE_B]=min(1,v[EB] + v[AB] * lightContribution[LIGHT_AMBIENT_R] + v[DB] * lightContribution[LIGHT_DIFFUSE_B]);
  triColor[TRI_DIFFUSE_A]=min(1,v[DA]);
  triColor[TRI_SPECULAR_R]=min(1,v[SPR] * lightContribution[LIGHT_SPECULAR_R]);
  triColor[TRI_SPECULAR_G]=min(1,v[SPG] * lightContribution[LIGHT_SPECULAR_G]);
  triColor[TRI_SPECULAR_B]=min(1,v[SPB] * lightContribution[LIGHT_SPECULAR_B]);
  triColor[TRI_SPECULAR_A]=min(1,v[SPA]);
}
