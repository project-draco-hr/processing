{
  if (!depth)   return screenX(x,y);
  float ax=m00 * x + m01 * y + m02 * z + m03;
  float ay=m10 * x + m11 * y + m12 * z + m13;
  float az=m20 * x + m21 * y + m22 * z + m23;
  float aw=m30 * x + m31 * y + m32 * z + m33;
  float ox=p00 * ax + p01 * ay + p02 * az + p03 * aw;
  float ow=p30 * ax + p31 * ay + p32 * az + p33 * aw;
  if (ow != 0)   ox/=ow;
  return width * (1 + ox) / 2.0f;
}
