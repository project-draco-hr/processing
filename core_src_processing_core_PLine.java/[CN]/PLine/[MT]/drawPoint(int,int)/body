{
  float iz=m_z0;
  int offset=y0 * SCREEN_WIDTH + x0;
  if (m_zbuffer == null) {
    m_pixels[offset]=m_stroke;
  }
 else {
    if (noDepthTest || iz <= m_zbuffer[offset]) {
      m_pixels[offset]=m_stroke;
      if (updateZBuffer)       m_zbuffer[offset]=iz;
    }
  }
}
