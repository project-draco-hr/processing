{
  int pivot=right;
  do {
    while (sort_compare(++left,pivot) < 0) {
    }
    while ((right != 0) && (sort_compare(--right,pivot) > 0)) {
    }
    sort_swap(left,right);
  }
 while (left < right);
  sort_swap(left,right);
  return left;
}
