{
  try {
    if (tmpdir != null) {
      System.setProperty("launch4j.tmpdir",tmpdir.getPath());
    }
    if (bindir != null) {
      System.setProperty("launch4j.bindir",bindir.getPath());
    }
    if (_configFile != null && _config != null) {
      throw new BuildException(Messages.getString("Launch4jTask.specify.config"));
    }
 else     if (_configFile != null) {
      ConfigPersister.getInstance().load(_configFile);
      Config c=ConfigPersister.getInstance().getConfig();
      if (jar != null) {
        c.setJar(jar);
      }
      if (outfile != null) {
        c.setOutfile(outfile);
      }
      if (fileVersion != null) {
        c.getVersionInfo().setFileVersion(fileVersion);
      }
      if (txtFileVersion != null) {
        c.getVersionInfo().setTxtFileVersion(txtFileVersion);
      }
      if (productVersion != null) {
        c.getVersionInfo().setProductVersion(productVersion);
      }
      if (txtProductVersion != null) {
        c.getVersionInfo().setTxtProductVersion(txtProductVersion);
      }
    }
 else     if (_config != null) {
      _config.unwrap();
      ConfigPersister.getInstance().setAntConfig(_config,getProject().getBaseDir());
    }
 else {
      throw new BuildException(Messages.getString("Launch4jTask.specify.config"));
    }
    final Builder b=new Builder(Log.getAntLog());
    b.build();
  }
 catch (  ConfigPersisterException e) {
    throw new BuildException(e);
  }
catch (  BuilderException e) {
    throw new BuildException(e);
  }
}
