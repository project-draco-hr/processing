{
  Document doc=textPane.getDocument();
  if (doc instanceof HTMLDocument) {
    HTMLDocument html=(HTMLDocument)doc;
    StyleSheet stylesheet=html.getStyleSheet();
    if (isSelected) {
      Color linkColor=UIManager.getColor("List.selectionForeground");
      stylesheet.addRule("a {color:" + toHex(linkColor) + ";"+ "text-decoration:underline}");
    }
 else {
      Color foreground=UIManager.getColor("List.foreground");
      stylesheet.addRule("a {color:" + toHex(foreground) + ";"+ "text-decoration:none}");
    }
  }
}
