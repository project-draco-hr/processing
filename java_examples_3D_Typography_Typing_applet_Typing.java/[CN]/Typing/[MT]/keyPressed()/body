{
  char k;
  k=(char)key;
switch (k) {
case 8:
    if (buff.length() > 0) {
      buff=buff.substring(1);
    }
  break;
case 13:
case 10:
case 65535:
case 127:
case 27:
break;
default :
if (textWidth(buff + k) + leftmargin < width - rightmargin) {
didntTypeYet=false;
buff=k + buff;
}
break;
}
}
