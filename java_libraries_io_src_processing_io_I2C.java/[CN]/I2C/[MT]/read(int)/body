{
  if (!transmitting) {
    throw new RuntimeException("beginTransmisson has not been called");
  }
  byte[] in=new byte[len];
  int ret=NativeInterface.transferI2c(handle,slave,out,in);
  transmitting=false;
  out=null;
  if (ret < 0) {
    throw new RuntimeException(NativeInterface.getError(ret));
  }
  return in;
}
