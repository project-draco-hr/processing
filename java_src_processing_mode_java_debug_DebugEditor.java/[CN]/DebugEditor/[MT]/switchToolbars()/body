{
  final EditorToolbar nextToolbar;
  if (debugToolbarEnabled.get()) {
    if (javaToolbar == null)     javaToolbar=createToolbar();
    nextToolbar=javaToolbar;
    debugToolbarEnabled.set(false);
    Base.log("Switching to Java Mode Toolbar");
  }
 else {
    if (debugToolbar == null)     debugToolbar=new DebugToolbar(this,getBase());
    nextToolbar=debugToolbar;
    debugToolbarEnabled.set(true);
    Base.log("Switching to Debugger Toolbar");
  }
  SwingUtilities.invokeLater(new Runnable(){
    public void run(){
      Box upper=(Box)splitPane.getComponent(0);
      upper.remove(0);
      upper.add(nextToolbar,0);
      upper.validate();
      nextToolbar.repaint();
      toolbar=nextToolbar;
      for (      KeyListener kl : textarea.getKeyListeners()) {
        if (kl instanceof EditorToolbar) {
          textarea.removeKeyListener(kl);
          textarea.addKeyListener(toolbar);
          break;
        }
      }
      ta.repaint();
    }
  }
);
}
