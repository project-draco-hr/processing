{
  if (newSketchName.equals(sketchName)) {
    return;
  }
  String textareaContents=textarea.getText();
  int textareaPosition=textarea.getCaretPosition();
  File newSketchDir=new File(sketchDir.getParent() + File.separator + newSketchName);
  File newSketchFile=new File(newSketchDir,newSketchName + ".pde");
  newSketchDir.mkdirs();
  copyFile(sketchFile,newSketchFile);
  copyDir(sketchDir,newSketchDir);
  new File(newSketchDir,sketchName + ".pde").delete();
  base.rebuildSketchbookMenu();
  handleOpen(newSketchName,newSketchFile,newSketchDir);
  textarea.editorSetText(textareaContents);
  textarea.setCaretPosition(textareaPosition);
  doSave();
}
