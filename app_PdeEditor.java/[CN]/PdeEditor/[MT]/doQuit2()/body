{
  doStop();
  if (PdeBase.getBoolean("sketchbook.auto_clean",true)) {
    String userPath=base.sketchbookPath + File.separator + userName;
    File userFolder=new File(userPath);
    if (userFolder.exists()) {
      String entries[]=new File(userPath).list();
      if (entries != null) {
        for (int j=0; j < entries.length; j++) {
          if ((entries[j].equals(".")) || (entries[j].equals("..")))           continue;
          File preyDir=new File(userPath,entries[j]);
          File prey=new File(preyDir,entries[j] + ".pde");
          if (prey.exists()) {
            if (prey.length() == 0) {
              removeDir(preyDir);
            }
          }
 else {
          }
        }
      }
    }
  }
  try {
    FileOutputStream output=null;
    if (PdeBase.platform == PdeBase.MACOSX) {
      output=new FileOutputStream("lib/sketch.properties");
    }
 else     if (PdeBase.platform == PdeBase.MACOS9) {
      output=new FileOutputStream("lib/sketch.properties");
    }
 else {
      URL url=getClass().getResource("buttons.gif");
      String urlstr=url.getFile();
      urlstr=urlstr.substring(0,urlstr.lastIndexOf("/") + 1) + "sketch.properties";
      output=new FileOutputStream(urlstr);
    }
    Properties skprops=new Properties();
    Rectangle window=PdeBase.frame.getBounds();
    Dimension screen=Toolkit.getDefaultToolkit().getScreenSize();
    skprops.put("window.x",String.valueOf(window.x));
    skprops.put("window.y",String.valueOf(window.y));
    skprops.put("window.w",String.valueOf(window.width));
    skprops.put("window.h",String.valueOf(window.height));
    skprops.put("screen.w",String.valueOf(screen.width));
    skprops.put("screen.h",String.valueOf(screen.height));
    skprops.put("sketch.name",sketchName);
    skprops.put("sketch.directory",sketchDir.getCanonicalPath());
    skprops.put("user.name",userName);
    skprops.save(output,"auto-generated by pde, please don't touch");
  }
 catch (  IOException e) {
    System.err.println("doQuit: error saving properties");
    e.printStackTrace();
  }
  System.exit(0);
}
