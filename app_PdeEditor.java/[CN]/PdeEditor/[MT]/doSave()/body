{
  message("Saving file...");
  String s=textarea.getText();
  FileDialog fd=new FileDialog(new Frame(),"Save PDE program as...",FileDialog.SAVE);
  fd.setDirectory(lastDirectory);
  fd.setFile(lastFile);
  fd.show();
  String directory=fd.getDirectory();
  String filename=fd.getFile();
  if (filename == null) {
    message(EMPTY);
    buttons.clear();
    return;
  }
  File file=new File(directory,filename);
  try {
    FileWriter writer=new FileWriter(file);
    writer.write(s);
    writer.flush();
    writer.close();
    lastDirectory=directory;
    lastFile=filename;
    message("Done saving file.");
  }
 catch (  IOException e) {
    e.printStackTrace();
    message("Did not write file.");
  }
  buttons.clear();
}
