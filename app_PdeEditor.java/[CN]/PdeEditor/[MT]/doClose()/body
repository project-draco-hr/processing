{
  if (engine != null) {
    if ((presentationWindow == null) || (!presentationWindow.isVisible())) {
      appletLocation=engine.window.getLocation();
    }
  }
  if (running) {
    doStop();
  }
  try {
    engine.close();
    engine=null;
  }
 catch (  Exception e) {
  }
  buttons.clear();
}
