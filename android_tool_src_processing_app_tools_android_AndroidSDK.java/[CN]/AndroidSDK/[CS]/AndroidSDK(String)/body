{
  sdk=new File(sdkPath);
  if (!sdk.exists()) {
    throw new BadSDKException(sdk + " does not exist");
  }
  tools=new File(sdk,"tools");
  if (!tools.exists()) {
    throw new BadSDKException("There is no tools folder in " + sdk);
  }
  androidTool=findAndroidTool(tools);
  final Platform p=Base.getPlatform();
  String path=p.getenv("PATH");
  p.setenv("ANDROID_SDK",sdk.getCanonicalPath());
  path=tools.getCanonicalPath() + File.pathSeparator + path;
  final String javaHomeProp=System.getProperty("java.home");
  if (javaHomeProp == null) {
    throw new RuntimeException("I don't know how to deal with a null java.home proprty, to be quite frank.");
  }
  final File javaHome=new File(javaHomeProp).getCanonicalFile();
  p.setenv("JAVA_HOME",javaHome.getCanonicalPath());
  path=new File(javaHome,"bin").getCanonicalPath() + File.pathSeparator + path;
  p.setenv("PATH",path);
}
