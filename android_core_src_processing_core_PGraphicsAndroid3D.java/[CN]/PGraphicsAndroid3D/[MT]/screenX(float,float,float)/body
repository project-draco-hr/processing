{
  y=-1 * y;
  if (!modelviewUpdated) {
    getModelviewMatrix();
  }
  if (!projectionUpdated) {
    getProjectionMatrix();
  }
  float ax=glmodelview[0] * x + glmodelview[4] * y + glmodelview[8] * z + glmodelview[12];
  float ay=glmodelview[1] * x + glmodelview[5] * y + glmodelview[9] * z + glmodelview[13];
  float az=glmodelview[2] * x + glmodelview[6] * y + glmodelview[10] * z + glmodelview[14];
  float aw=glmodelview[3] * x + glmodelview[7] * y + glmodelview[11] * z + glmodelview[15];
  float ox=glprojection[0] * ax + glprojection[4] * ay + glprojection[8] * az + glprojection[12] * aw;
  float ow=glprojection[3] * ax + glprojection[7] * ay + glprojection[11] * az + glprojection[15] * aw;
  if (ow != 0) {
    ox/=ow;
  }
  return width * (1 + ox) / 2.0f;
}
