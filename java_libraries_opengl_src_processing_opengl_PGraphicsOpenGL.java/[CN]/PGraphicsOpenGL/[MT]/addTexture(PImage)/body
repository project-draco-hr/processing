{
  Texture.Parameters params=(Texture.Parameters)img.getParams(pgPrimary);
  if (params == null) {
    params=new Texture.Parameters();
    if (hints[DISABLE_TEXTURE_MIPMAPS]) {
      params.mipmaps=false;
    }
 else {
      params.mipmaps=true;
    }
    if (textureQuality == Texture.LOW) {
      params.sampling=POINT;
    }
 else     if (textureQuality == Texture.MEDIUM) {
      params.sampling=Texture.LINEAR;
    }
 else     if (textureQuality == Texture.HIGH) {
      params.sampling=Texture.BILINEAR;
    }
 else     if (textureQuality == Texture.BEST) {
      if (params.mipmaps) {
        params.sampling=Texture.TRILINEAR;
      }
 else {
        params.sampling=Texture.BILINEAR;
        PGraphics.showWarning("BEST texture quality requires mipmaps, will switch to HIGH.");
      }
    }
    params.wrapU=textureWrap;
    params.wrapV=textureWrap;
    img.setParams(pgPrimary,params);
  }
  if (img.parent == null) {
    img.parent=parent;
  }
  Texture tex=new Texture(img.parent,img.width,img.height,params);
  if (img.pixels == null) {
    img.loadPixels();
  }
  if (img.pixels != null)   tex.set(img.pixels);
  img.setCache(pgPrimary,tex);
  return tex;
}
