{
  if (primarySurface) {
    boolean needEndDraw=false;
    if (!drawing) {
      beginDraw();
      needEndDraw=true;
    }
    loadTextureImpl(Texture.POINT,false);
    flush();
    if (pgl.primaryIsFboBacked()) {
      texture.set(pgl.getFboTexTarget(),pgl.getFboTexName(),pgl.getFboWidth(),pgl.getFboHeight(),width,height);
    }
 else {
      if (nativePixels == null || nativePixels.length < width * height) {
        nativePixels=new int[width * height];
        nativePixelBuffer=IntBuffer.wrap(nativePixels);
      }
      beginPixelsOp(OP_READ);
      pgl.glReadPixels(0,0,width,height,PGL.GL_RGBA,PGL.GL_UNSIGNED_BYTE,nativePixelBuffer);
      endPixelsOp();
      texture.setNative(nativePixels,0,0,width,height);
    }
    if (needEndDraw) {
      endDraw();
    }
  }
}
