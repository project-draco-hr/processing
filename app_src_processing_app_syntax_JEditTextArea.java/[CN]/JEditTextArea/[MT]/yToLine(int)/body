{
  FontMetrics fm=painter.getFontMetrics();
  int height=fm.getHeight();
  return Math.max(0,Math.min(getLineCount() - 1,y / height + firstLine));
}
