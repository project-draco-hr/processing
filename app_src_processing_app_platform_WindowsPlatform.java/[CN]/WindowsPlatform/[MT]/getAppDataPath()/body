{
  char[] pszPath=new char[WinDef.MAX_PATH];
  HRESULT hResult=Shell32.INSTANCE.SHGetFolderPath(null,ShlObj.CSIDL_APPDATA,null,ShlObj.SHGFP_TYPE_CURRENT,pszPath);
  if (!hResult.equals(WinError.S_OK)) {
    throw new Exception(Kernel32Util.formatMessageFromHR(hResult));
  }
  String appDataPath=new String(pszPath);
  int len=appDataPath.indexOf("\0");
  return appDataPath.substring(0,len);
}
