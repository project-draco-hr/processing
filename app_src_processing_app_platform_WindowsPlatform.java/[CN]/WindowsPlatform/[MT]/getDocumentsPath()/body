{
  char[] pszPath=new char[WinDef.MAX_PATH];
  HRESULT hResult=Shell32.INSTANCE.SHGetFolderPath(null,ShlObj.CSIDL_PERSONAL,null,ShlObj.SHGFP_TYPE_CURRENT,pszPath);
  if (!hResult.equals(WinError.S_OK)) {
    throw new Exception(Kernel32Util.formatMessageFromHR(hResult));
  }
  String personalPath=new String(pszPath);
  int len=personalPath.indexOf("\0");
  return personalPath.substring(0,len);
}
