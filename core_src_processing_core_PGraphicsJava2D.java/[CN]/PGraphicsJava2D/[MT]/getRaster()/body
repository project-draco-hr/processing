{
  if (primarySurface) {
    if (useOffscreen) {
      return ((BufferedImage)offscreen).getRaster();
    }
    if (image instanceof VolatileImage) {
      return ((VolatileImage)image).getSnapshot().getRaster();
    }
  }
  return ((BufferedImage)image).getRaster();
}
