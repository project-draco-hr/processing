{
  ensureExistence();
  if (editor != null) {
    current.setProgram(editor.getText());
    if (Preferences.getBoolean("editor.external")) {
      current=null;
      load();
    }
  }
  if (targetFolder != null) {
    if (Preferences.getBoolean("export.delete_target_folder")) {
      System.out.println("temporarily skipping deletion of " + targetFolder);
    }
    targetFolder.mkdirs();
  }
}
