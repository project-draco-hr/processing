{
  ProcessResult result;
  try {
    System.out.println("listing devices 00");
    result=AndroidSDK.runADB("devices");
    System.out.println("listing devices 05");
  }
 catch (  InterruptedException e) {
    return Collections.emptyList();
  }
catch (  IOException e) {
    e.printStackTrace();
    return Collections.emptyList();
  }
  System.out.println("listing devices 10");
  if (!result.succeeded()) {
    if (result.getStderr().contains("protocol fault (no status)")) {
      System.err.println("bleh: " + result);
    }
 else {
      System.err.println("nope: " + result);
    }
    return Collections.emptyList();
  }
  System.out.println("listing devices 20");
  final String stdout=result.getStdout();
  if (!(stdout.startsWith("List of devices") || stdout.trim().length() == 0)) {
    System.err.println(ADB_DEVICES_ERROR);
    return Collections.emptyList();
  }
  System.out.println("listing devices 30");
  final List<String> devices=new ArrayList<String>();
  for (  final String line : result) {
    if (!line.contains("\t")) {
      continue;
    }
    final String[] fields=line.split("\t");
    if (fields[1].equals("device")) {
      devices.add(fields[0]);
    }
  }
  return devices;
}
