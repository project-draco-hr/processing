{
  ProcessResult result;
  try {
    result=AndroidSDK.runADB("devices");
  }
 catch (  final InterruptedException e) {
    return Collections.emptyList();
  }
catch (  final IOException e) {
    System.err.println(e);
    return Collections.emptyList();
  }
  if (!result.succeeded()) {
    System.err.println(result);
    return Collections.emptyList();
  }
  final String stdout=result.getStdout();
  if (!(stdout.startsWith("List of devices") || stdout.trim().length() == 0)) {
    System.err.println(result);
    System.err.println(ADB_DEVICES_ERROR);
    return Collections.emptyList();
  }
  final List<String> devices=new ArrayList<String>();
  for (  final String line : result) {
    if (!line.contains("\t")) {
      continue;
    }
    final String[] fields=line.split("\t");
    if (fields[1].equals("device")) {
      devices.add(fields[0]);
    }
  }
  return devices;
}
