{
  report("top endDraw()");
  super.endDraw();
  if (USE_GBUFFER && GBUFFER_MERGE_ALL) {
    gl2f.glEnableClientState(GL2.GL_VERTEX_ARRAY);
    gl2f.glEnableClientState(GL2.GL_COLOR_ARRAY);
    gl2f.glEnableClientState(GL2.GL_NORMAL_ARRAY);
    gbuffer.render();
    gl2f.glDisableClientState(GL2.GL_NORMAL_ARRAY);
    gl2f.glDisableClientState(GL2.GL_COLOR_ARRAY);
    gl2f.glDisableClientState(GL2.GL_VERTEX_ARRAY);
  }
  if (hints[ENABLE_DEPTH_SORT]) {
    flush();
  }
  if (primarySurface) {
    gl.glFlush();
    if (drawable != null) {
      drawable.swapBuffers();
      releaseContext();
    }
  }
 else {
    if (offscreenMultisample) {
      offscreenFramebufferMultisample.copy(offscreenFramebuffer);
    }
    popFramebuffer();
    pgl.restoreGLState();
  }
  report("bot endDraw()");
}
