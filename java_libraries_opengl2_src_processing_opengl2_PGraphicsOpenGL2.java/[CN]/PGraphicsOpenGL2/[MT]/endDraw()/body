{
  report("top endDraw()");
  if (USE_GBUFFER) {
    if (GBUFFER_MERGE_ALL && gbuffer != null && 0 < gbuffer.vertCount) {
      gbuffer.pre();
      gbuffer.render();
      gbuffer.post();
    }
  }
  if (hints[ENABLE_DEPTH_SORT]) {
    flush();
  }
  if (primarySurface) {
    gl.glFlush();
    if (drawable != null) {
      drawable.swapBuffers();
      releaseContext();
    }
  }
 else {
    if (offscreenMultisample) {
      offscreenFramebufferMultisample.copy(offscreenFramebuffer);
    }
    popFramebuffer();
    ogl.restoreGLState();
  }
  report("bot endDraw()");
}
