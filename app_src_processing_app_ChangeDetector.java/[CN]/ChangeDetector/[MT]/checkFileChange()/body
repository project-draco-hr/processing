{
  if (sketch == null) {
    return;
  }
  sketch.ensureExistence();
  File sketchFolder=sketch.getFolder();
  File[] sketchFiles=sketchFolder.listFiles(new FilenameFilter(){
    @Override public boolean accept(    File dir,    String name){
      for (      String s : editor.getMode().getExtensions()) {
        if (name.toLowerCase().endsWith(s.toLowerCase())) {
          return true;
        }
      }
      return false;
    }
  }
);
  int fileCount=sketchFiles.length;
  if (fileCount != sketch.getCodeCount()) {
    if (reloadSketch(null) && fileCount < 1) {
      try {
        sketch.getMainFile().createNewFile();
      }
 catch (      Exception e1) {
        showErrorEDT("Reload failed","The sketch contains no code files.",e1);
        skip=true;
        return;
      }
      sketch.reload();
      showWarningEDT("Modified Reload","You cannot delete the last code file in a sketch.\n" + "A new blank sketch file has been generated for you.");
    }
    return;
  }
  SketchCode[] codes=sketch.getCode();
  for (  SketchCode sc : codes) {
    File sketchFile=sc.getFile();
    if (sketchFile.exists()) {
      long diff=sketchFile.lastModified() - sc.lastModified();
      if (diff != 0) {
        if (Base.isMacOS() && diff < 1000L + MODIFIED_TIME_BUFFER) {
          continue;
        }
 else         if (diff < MODIFIED_TIME_BUFFER) {
          continue;
        }
        reloadSketch(sc);
        return;
      }
    }
 else {
      reloadSketch(sc);
      return;
    }
  }
}
