{
  int line=0;
  while (offset >= 0) {
    offset=text.lastIndexOf('\n',offset - 1);
    line++;
  }
  return line - 1;
}
