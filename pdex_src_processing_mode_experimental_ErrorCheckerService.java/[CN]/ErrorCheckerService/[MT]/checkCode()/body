{
  log("checkCode() " + textModified.get());
  lastTimeStamp=System.currentTimeMillis();
  try {
    sourceCode=preprocessCode(editor.getSketch().getMainProgram());
    compilationUnitState=0;
    syntaxCheck();
    log(editor.getSketch().getName() + "1 MCO " + mainClassOffset);
    if (!hasSyntaxErrors()) {
    }
    if (problems.length == 0 && editor.compilationCheckEnabled) {
      sourceCode=xqpreproc.doYourThing(sourceCode,programImports);
      prepareCompilerClasspath();
      compileCheck();
      log(editor.getSketch().getName() + "2 MCO " + mainClassOffset);
    }
    astGenerator.buildAST(cu);
    if (ExperimentalMode.errorCheckEnabled) {
      updateErrorTable();
      editor.updateErrorBar(problemsList);
      updateEditorStatus();
      editor.getTextArea().repaint();
      updatePaintedThingys();
      editor.updateErrorToggle();
    }
 else {
      log("Error Check disabled, so not updating UI.");
    }
    int x=textModified.get();
    if (x >= 2) {
      textModified.set(2);
      x=2;
    }
    if (x > 0)     textModified.set(x - 1);
 else     textModified.set(0);
    return true;
  }
 catch (  Exception e) {
    log("Oops! [ErrorCheckerService.checkCode]: " + e);
    e.printStackTrace();
  }
  return false;
}
