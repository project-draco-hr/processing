{
  boolean success=false;
  try {
    success=editor.sketch.save();
  }
 catch (  Exception e) {
    e.printStackTrace();
  }
  if (!success) {
    Base.showWarning("Couldn't archive sketch","Archiving the sketch has been canceled because\n" + "the sketch couldn't save properly.",null);
    return;
  }
  File location=editor.sketch.folder;
  String name=location.getName();
  File parent=new File(location.getParent());
  File newbie=null;
  String namely=null;
  int index=0;
  do {
    if (useDate) {
      String purty=dateFormat.format(new Date());
      String stamp=purty + ((char)('a' + index));
      namely=name + "-" + stamp;
      newbie=new File(parent,namely + ".zip");
    }
 else {
      String diggie=numberFormat.format(index + 1);
      namely=name + "-" + diggie;
      newbie=new File(parent,namely + ".zip");
    }
    index++;
  }
 while (newbie.exists());
  try {
    FileOutputStream zipOutputFile=new FileOutputStream(newbie);
    ZipOutputStream zos=new ZipOutputStream(zipOutputFile);
    buildZip(location,name,zos);
    zos.flush();
    zos.close();
    editor.message("Created archive " + newbie.getName() + ".");
  }
 catch (  IOException e) {
    e.printStackTrace();
  }
}
