{
  AttributedString composed=new AttributedString(text,committed_count,text.getEndIndex());
  Font font=textArea.getPainter().getFont();
  FontRenderContext context=((Graphics2D)(textArea.getPainter().getGraphics())).getFontRenderContext();
  composed.addAttribute(TextAttribute.FONT,font);
  TextLayout layout=new TextLayout(composed.getIterator(),context);
  return layout;
}
