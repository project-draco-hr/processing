{
  ProcessResult result;
  try {
    result=AndroidSDK.runADB("devices");
  }
 catch (  InterruptedException e) {
    return Collections.emptyList();
  }
catch (  IOException e) {
    System.err.println("Problem inside Devices.list()");
    e.printStackTrace();
    return Collections.emptyList();
  }
  if (!result.succeeded()) {
    if (result.getStderr().contains("protocol fault (no status)")) {
      System.err.println("bleh: " + result);
    }
 else {
      System.err.println("nope: " + result);
    }
    return Collections.emptyList();
  }
  final String stdout=result.getStdout();
  if (!(stdout.startsWith("List of devices") || stdout.trim().length() == 0)) {
    System.err.println(ADB_DEVICES_ERROR);
    System.err.println("Output was ???" + stdout + "???");
    return Collections.emptyList();
  }
  final List<String> devices=new ArrayList<String>();
  for (  final String line : result) {
    if (line.contains("\t")) {
      final String[] fields=line.split("\t");
      if (fields[1].equals("device")) {
        devices.add(fields[0]);
      }
    }
  }
  return devices;
}
