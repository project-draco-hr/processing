{
  final IndeterminateProgressMonitor monitor=new IndeterminateProgressMonitor(editor,"Building and exporting...","Creating project...");
  try {
    File tempFolder=build.createProject();
    if (tempFolder == null) {
      return;
    }
    try {
      if (monitor.isCanceled()) {
        throw new MonitorCanceled();
      }
      monitor.setNote("Building release version...");
      if (!build.antBuild("release")) {
        return;
      }
      if (monitor.isCanceled()) {
        throw new MonitorCanceled();
      }
      File exportFolder=build.createExportFolder();
      if (exportFolder != null) {
        Base.copyDir(tempFolder,exportFolder);
        editor.statusNotice("Done with export.");
        Base.openFolder(exportFolder);
      }
 else {
        editor.statusError("Could not copy files to export folder.");
      }
    }
 catch (    IOException e) {
      editor.statusError(e);
    }
 finally {
      build.cleanup();
    }
  }
  finally {
    monitor.close();
  }
}
