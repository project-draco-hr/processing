{
  final boolean emu=device.startsWith("emulator");
  editor.statusNotice("Sending sketch to the " + (emu ? "emulator" : "phone") + ".");
  try {
    final ProcessHelper p=new ProcessHelper("adb","-s",device,"install","-r",build.getPathForAPK("debug"));
    final ProcessResult installResult=p.execute();
    if (!installResult.succeeded()) {
      editor.statusError("Could not install the sketch.");
      System.err.println(installResult);
      return false;
    }
    String errorMsg=null;
    for (    final String out : installResult) {
      if (out.startsWith("Failure")) {
        errorMsg=out.substring(8);
        System.err.println(out);
      }
 else {
        System.out.println(out);
      }
    }
    if (errorMsg == null) {
      editor.statusNotice("Done installing.");
      return true;
    }
    editor.statusError("Error while installing " + errorMsg);
  }
 catch (  final IOException e) {
    editor.statusError(e);
  }
catch (  final InterruptedException e) {
    System.err.println("installSketch interrupted");
  }
  return false;
}
