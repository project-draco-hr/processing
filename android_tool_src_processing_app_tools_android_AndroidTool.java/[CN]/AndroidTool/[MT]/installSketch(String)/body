{
  final boolean emu=device.startsWith("emulator");
  editor.statusNotice("Sending sketch to the " + (emu ? "emulator" : "phone") + ".");
  try {
    final ProcessHelper p=new ProcessHelper("adb","-s",device,"install","-r",build.getPathForAPK("debug"));
    System.out.println();
    System.out.print("Install command: ");
    System.out.println(p.getCommand());
    final int result=p.execute();
    if (result != 0) {
      p.dump();
      editor.statusError("Could not install the sketch.");
      System.err.println("???adb install??? returned " + result + ".");
      return false;
    }
    String errorMsg=null;
    for (    final String out : p.getStdout().split("\n")) {
      if (out.startsWith("Failure")) {
        errorMsg=out.substring(8);
        System.err.println(out);
      }
 else {
        System.out.println(out);
      }
    }
    if (errorMsg == null) {
      editor.statusNotice("Done installing.");
      return true;
    }
    editor.statusError("Error while installing " + errorMsg);
  }
 catch (  final IOException e) {
    editor.statusError(e);
  }
catch (  final InterruptedException e) {
  }
  return false;
}
