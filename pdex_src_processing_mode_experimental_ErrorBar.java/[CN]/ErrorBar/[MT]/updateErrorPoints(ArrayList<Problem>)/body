{
  final int fheight=this.getHeight();
  SwingWorker worker=new SwingWorker(){
    protected Object doInBackground() throws Exception {
      SketchCode sc=editor.getSketch().getCurrentCode();
      int totalLines=0, currentTab=editor.getSketch().getCurrentCodeIndex();
      try {
        totalLines=Base.countLines(sc.getDocument().getText(0,sc.getDocument().getLength())) + 1;
      }
 catch (      BadLocationException e) {
        e.printStackTrace();
      }
      errorPointsOld.clear();
      for (      ErrorMarker marker : errorPoints) {
        errorPointsOld.add(marker);
      }
      errorPoints.clear();
      for (      Problem problem : problems) {
        if (problem.tabIndex == currentTab) {
          float y=(problem.lineNumber - errorCheckerService.defaultImportsOffset) / ((float)totalLines);
          y*=fheight - 15;
          errorPoints.add(new ErrorMarker(problem,(int)y,problem.isError() ? ErrorMarker.Error : ErrorMarker.Warning));
        }
      }
      return null;
    }
    protected void done(){
      repaint();
    }
  }
;
  try {
    worker.execute();
  }
 catch (  Exception exp) {
    System.out.println("Errorbar update markers is slacking." + exp.getMessage());
  }
}
