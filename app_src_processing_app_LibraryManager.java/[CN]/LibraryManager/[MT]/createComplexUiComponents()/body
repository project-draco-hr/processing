{
  dialog.setResizable(true);
  Container pane=dialog.getContentPane();
  pane.setLayout(new GridBagLayout());
  GridBagConstraints c=new GridBagConstraints();
  c.gridx=0;
  c.gridy=0;
  c.gridwidth=2;
  c.weightx=1;
  c.fill=GridBagConstraints.HORIZONTAL;
  filterField=new FilterField();
  pane.add(filterField,c);
  libraryListPane=new LibraryListPanel(this);
  c=new GridBagConstraints();
  c.fill=GridBagConstraints.BOTH;
  c.gridx=0;
  c.gridy=1;
  c.gridwidth=2;
  c.weighty=1;
  c.weightx=1;
  final JScrollPane scrollPane=new JScrollPane();
  scrollPane.setPreferredSize(new Dimension(300,300));
  scrollPane.setViewportView(libraryListPane);
  scrollPane.getViewport().setOpaque(true);
  scrollPane.getViewport().setBackground(libraryListPane.getBackground());
  scrollPane.setVerticalScrollBarPolicy(ScrollPaneConstants.VERTICAL_SCROLLBAR_ALWAYS);
  pane.add(scrollPane,c);
  scrollPane.setHorizontalScrollBarPolicy(JScrollPane.HORIZONTAL_SCROLLBAR_NEVER);
  libraryListPane.setPreferredViewPositionListener(new PreferredViewPositionListener(){
    public void handlePreferredLocation(    Point p){
      scrollPane.getViewport().setViewPosition(p);
    }
  }
);
  c=new GridBagConstraints();
  c.gridx=0;
  c.gridy=2;
  pane.add(new Label("Category:"),c);
  c=new GridBagConstraints();
  c.fill=GridBagConstraints.HORIZONTAL;
  c.gridx=1;
  c.gridy=2;
  ArrayList<String> categories=new ArrayList<String>(getLibraryListing(null).getCategories());
  Collections.sort(categories);
  categories.add(0,ANY_CATEGORY);
  categoryChooser=new JComboBox(categories.toArray());
  pane.add(categoryChooser,c);
  categoryChooser.addItemListener(new ItemListener(){
    public void itemStateChanged(    ItemEvent e){
      category=(String)categoryChooser.getSelectedItem();
      if (ANY_CATEGORY.equals(category)) {
        category=null;
      }
      libraryListPane.filterLibraries(category,filterField.filters);
    }
  }
);
  dialog.setMinimumSize(new Dimension(650,400));
}
