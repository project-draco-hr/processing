{
  int modifiers=nativeEvent.getModifiers();
  int peModifiers=modifiers & (InputEvent.SHIFT_MASK | InputEvent.CTRL_MASK | InputEvent.META_MASK| InputEvent.ALT_MASK);
  int peButton=0;
  if ((modifiers & InputEvent.BUTTON1_MASK) != 0) {
    peButton=PConstants.LEFT;
  }
 else   if ((modifiers & InputEvent.BUTTON2_MASK) != 0) {
    peButton=PConstants.CENTER;
  }
 else   if ((modifiers & InputEvent.BUTTON3_MASK) != 0) {
    peButton=PConstants.RIGHT;
  }
  if (PApplet.platform == PConstants.MACOSX) {
    if ((modifiers & InputEvent.CTRL_MASK) != 0) {
      peButton=PConstants.RIGHT;
    }
  }
  int peCount=0;
  if (peAction == MouseEvent.WHEEL) {
    peCount=nativeEvent.isShiftDown() ? (int)nativeEvent.getRotation()[0] : (int)nativeEvent.getRotation()[1];
  }
 else {
    peCount=nativeEvent.getClickCount();
  }
  MouseEvent me=new MouseEvent(nativeEvent,nativeEvent.getWhen(),peAction,peModifiers,nativeEvent.getX(),nativeEvent.getY(),peButton,peCount);
  sketch.postEvent(me);
}
