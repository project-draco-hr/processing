{
  this.checkModifiedMode=checkModifiedMode;
  if (!sketch.modified) {
    checkModified2();
    return;
  }
  String prompt="Save changes to " + sketch.name + "?  ";
  if (checkModifiedMode != HANDLE_QUIT) {
    status.prompt(prompt);
  }
 else {
    if (!Base.isMacOS() || PApplet.javaVersion < 1.5f) {
      int result=JOptionPane.showConfirmDialog(this,prompt,"Quit",JOptionPane.YES_NO_CANCEL_OPTION,JOptionPane.QUESTION_MESSAGE);
      if (result == JOptionPane.YES_OPTION) {
        handleSave(true);
        checkModified2();
      }
 else       if (result == JOptionPane.NO_OPTION) {
        checkModified2();
      }
    }
 else {
      JOptionPane pane=new JOptionPane("<html> " + "<head> <style type=\"text/css\">" + "b { font: 13pt \"Lucida Grande\" }"+ "p { font: 11pt \"Lucida Grande\"; margin-top: 8px }"+ "</style> </head>"+ "<b>Do you want to save changes to this sketch<BR>"+ " before closing?</b>"+ "<p>If you don't save, your changes will be lost.",JOptionPane.QUESTION_MESSAGE);
      String[] options=new String[]{"Save","Cancel","Don't Save"};
      pane.setOptions(options);
      pane.setInitialValue(options[0]);
      pane.putClientProperty("Quaqua.OptionPane.destructiveOption",new Integer(2));
      JDialog dialog=pane.createDialog(this,null);
      dialog.show();
      Object result=pane.getValue();
      if (result == options[0]) {
        handleSave(true);
        checkModified2();
      }
 else       if (result == options[2]) {
        checkModified2();
      }
    }
  }
}
