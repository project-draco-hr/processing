{
  this.sketch=sketch;
  this.buildPath=buildPath;
  PdeMessageStream pms=new PdeMessageStream(this);
  String baseCommand[]=new String[]{((!PdeBase.isMacOS()) ? "jikes" : System.getProperty("user.dir") + File.separator + "jikes"),"-target",PdePreferences.get("preproc.jdk_version"),"-bootclasspath",calcBootClassPath(),"-classpath",sketch.classPath,"-nowarn","+E","-d",buildPath};
  String preprocNames[]=new String[sketch.codeCount];
  int preprocCount=0;
  for (int i=0; i < sketch.codeCount; i++) {
    if (sketch.code[i].preprocName != null) {
      preprocNames[preprocCount++]=sketch.code[i].preprocName;
    }
  }
  String command[]=new String[baseCommand.length + preprocCount];
  System.arraycopy(baseCommand,0,command,0,baseCommand.length);
  for (int i=0; i < preprocCount; i++) {
    command[baseCommand.length + i]=buildPath + File.separator + preprocNames[i];
  }
  firstErrorFound=false;
  secondErrorFound=false;
  int result=0;
  try {
    Process process=Runtime.getRuntime().exec(command);
    new PdeMessageSiphon(process.getInputStream(),this);
    new PdeMessageSiphon(process.getErrorStream(),this);
    boolean compiling=true;
    while (compiling) {
      try {
        result=process.waitFor();
        compiling=false;
      }
 catch (      InterruptedException ignored) {
      }
    }
  }
 catch (  Exception e) {
    String msg=e.getMessage();
    if ((msg != null) && (msg.indexOf("jikes: not found") != -1)) {
      PdeBase.showWarning("Compiler error","Could not find the compiler.\n" + "jikes is missing from your PATH,\n" + "see readme.txt for help.",null);
      return false;
    }
 else {
      e.printStackTrace();
      result=-1;
    }
  }
  if (exception != null)   throw exception;
  if (result != 0 && result != 1) {
    PdeBase.openURL(BUGS_URL);
    throw new PdeException(SUPER_BADNESS);
  }
  return (result == 0);
}
