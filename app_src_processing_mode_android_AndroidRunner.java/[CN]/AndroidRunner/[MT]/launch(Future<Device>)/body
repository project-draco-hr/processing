{
  listener.statusNotice("Waiting for device to become available...");
  final Device device=waitForDevice(deviceFuture,listener);
  if (device == null || !device.isAlive()) {
    listener.statusError("Lost connection with device while launching. Try again.");
    Devices.killAdbServer();
    return;
  }
  device.addListener(this);
  listener.statusNotice("Installing sketch on " + device.getId());
  if (!device.installApp(build.getPathForAPK(),listener)) {
    listener.statusError("Lost connection with device while installing. Try again.");
    Devices.killAdbServer();
    return;
  }
  listener.statusNotice("Starting sketch on " + device.getId());
  if (startSketch(build,device)) {
    listener.statusNotice("Sketch launched on the " + (device.isEmulator() ? "emulator" : "phone") + ".");
  }
 else {
    listener.statusError("Could not start the sketch.");
  }
  listener.stopIndeterminate();
  lastRunDevice=device;
}
