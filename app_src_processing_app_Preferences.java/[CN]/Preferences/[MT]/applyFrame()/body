{
  setBoolean("editor.antialias",editorAntialiasBox.isSelected());
  setBoolean("export.delete_target_folder",deletePreviousBox.isSelected());
  String oldPath=get("sketchbook.path");
  String newPath=sketchbookLocationField.getText();
  if (!newPath.equals(oldPath)) {
    base.setSketchbookFolder(new File(newPath));
  }
  setBoolean("update.check",checkUpdatesBox.isSelected());
  int oldDisplayIndex=getInteger("run.display");
  int displayIndex=0;
  for (int d=0; d < displaySelectionBox.getItemCount(); d++) {
    if (displaySelectionBox.getSelectedIndex() == d) {
      displayIndex=d;
    }
  }
  if (oldDisplayIndex != displayIndex) {
    setInteger("run.display",displayIndex);
    for (    Editor editor : base.getEditors()) {
      editor.setSketchLocation(null);
    }
  }
  setBoolean("run.options.memory",memoryOverrideBox.isSelected());
  int memoryMin=Preferences.getInteger("run.options.memory.initial");
  int memoryMax=Preferences.getInteger("run.options.memory.maximum");
  try {
    memoryMax=Integer.parseInt(memoryField.getText().trim());
    if (memoryMax < memoryMin)     memoryMax=memoryMin;
    setInteger("run.options.memory.maximum",memoryMax);
  }
 catch (  NumberFormatException e) {
    System.err.println("Ignoring bad memory setting");
  }
  if (Base.isMacOS()) {
    String oldBits=get("run.options.bits");
    String newBits=bitsThirtyTwoButton.isSelected() ? "32" : "64";
    if (!oldBits.equals(newBits)) {
      set("run.options.bits",newBits);
      for (      Mode m : base.getModeList()) {
        m.rebuildLibraryList();
      }
    }
  }
  String newSizeText=fontSizeField.getText();
  try {
    int newSize=Integer.parseInt(newSizeText.trim());
    String pieces[]=PApplet.split(get("editor.font"),',');
    pieces[2]=String.valueOf(newSize);
    set("editor.font",PApplet.join(pieces,','));
  }
 catch (  Exception e) {
    System.err.println("ignoring invalid font size " + newSizeText);
  }
  setBoolean("editor.input_method_support",inputMethodBox.isSelected());
  if (autoAssociateBox != null) {
    setBoolean("platform.auto_file_type_associations",autoAssociateBox.isSelected());
  }
  for (  Editor editor : base.getEditors()) {
    editor.applyPreferences();
  }
}
