{
  lastTimeStamp=System.currentTimeMillis();
  try {
    sourceCode=preprocessCode(editor.getSketch().getMainProgram());
    compilationUnitState=0;
    syntaxCheck();
    if (!hasSyntaxErrors()) {
    }
    if (problems.length == 0 && !editor.hasJavaTabs()) {
      sourceCode=xqpreproc.handle(sourceCode,programImports);
      prepareCompilerClasspath();
      compileCheck();
    }
synchronized (astGenerator) {
      astGenerator.buildAST(cu);
    }
    if (!JavaMode.errorCheckEnabled) {
      problemsList.clear();
      Messages.log("Error Check disabled, so not updating UI.");
    }
    calcPdeOffsetsForProbList();
    updateErrorTable();
    editor.updateErrorBar(problemsList);
    updateEditorStatus();
    editor.getTextArea().repaint();
    updatePaintedThingys();
    editor.updateErrorToggle();
    int x=textModified.get();
    if (x >= 2) {
      textModified.set(2);
      x=2;
    }
    if (x > 0)     textModified.set(x - 1);
 else     textModified.set(0);
    return true;
  }
 catch (  Exception e) {
    Messages.log("Oops! [ErrorCheckerService.checkCode]: " + e);
    e.printStackTrace();
  }
  return false;
}
