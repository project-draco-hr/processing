{
  JPanel panel=new JPanel();
  panel.setLayout(new BoxLayout(panel,BoxLayout.Y_AXIS));
  panel.add(Box.createVerticalStrut(6));
  String line1="Export to Application creates double-clickable,";
  String line2="standalone application for the current plaform.";
  JLabel label1=new JLabel(line1,SwingConstants.CENTER);
  JLabel label2=new JLabel(line2,SwingConstants.CENTER);
  label1.setAlignmentX(Component.LEFT_ALIGNMENT);
  label2.setAlignmentX(Component.LEFT_ALIGNMENT);
  panel.add(label1);
  panel.add(label2);
  int wide=Math.max(label1.getPreferredSize().width,label2.getPreferredSize().width);
  panel.add(Box.createVerticalStrut(12));
  int indent=0;
  final JCheckBox showStopButton=new JCheckBox("Show a Stop button");
  showStopButton.setSelected(Preferences.getBoolean("export.application.stop"));
  showStopButton.addItemListener(new ItemListener(){
    public void itemStateChanged(    ItemEvent e){
      Preferences.setBoolean("export.application.stop",showStopButton.isSelected());
    }
  }
);
  showStopButton.setEnabled(Preferences.getBoolean("export.application.fullscreen"));
  showStopButton.setBorder(new EmptyBorder(3,13 + indent,6,13));
  final JCheckBox fullScreenButton=new JCheckBox("Full Screen (Present mode)");
  fullScreenButton.setSelected(Preferences.getBoolean("export.application.fullscreen"));
  fullScreenButton.addItemListener(new ItemListener(){
    public void itemStateChanged(    ItemEvent e){
      boolean sal=fullScreenButton.isSelected();
      Preferences.setBoolean("export.application.fullscreen",sal);
      showStopButton.setEnabled(sal);
    }
  }
);
  fullScreenButton.setBorder(new EmptyBorder(3,13,3,13));
  boolean embed=Preferences.getBoolean("export.application.embed_java");
  final String embedWarning="Embedding Java makes larger applications";
  final String nopeWarning="Users will have to install the latest Java 7";
  final JLabel warningLabel=new JLabel(embed ? embedWarning : nopeWarning);
  warningLabel.setBorder(new EmptyBorder(3,13 + indent,3,13));
  final JCheckBox embedJavaButton=new JCheckBox("Embed Java");
  embedJavaButton.setSelected(embed);
  embedJavaButton.addItemListener(new ItemListener(){
    public void itemStateChanged(    ItemEvent e){
      boolean selected=embedJavaButton.isSelected();
      Preferences.setBoolean("export.application.embed_java",selected);
      if (selected) {
        warningLabel.setText(embedWarning);
      }
 else {
        warningLabel.setText(nopeWarning);
      }
    }
  }
);
  embedJavaButton.setBorder(new EmptyBorder(3,13,3,13));
  JPanel optionPanel=new JPanel();
  optionPanel.setLayout(new BoxLayout(optionPanel,BoxLayout.Y_AXIS));
  optionPanel.add(fullScreenButton);
  optionPanel.add(showStopButton);
  optionPanel.add(embedJavaButton);
  optionPanel.add(warningLabel);
  optionPanel.setBorder(new TitledBorder("Options"));
  optionPanel.setAlignmentX(Component.LEFT_ALIGNMENT);
  panel.add(optionPanel);
  Dimension good;
  good=new Dimension(wide,label1.getPreferredSize().height);
  label1.setMaximumSize(good);
  good=new Dimension(wide,label2.getPreferredSize().height);
  label2.setMaximumSize(good);
  good=new Dimension(wide,optionPanel.getPreferredSize().height);
  String[] options={"Export","Cancel"};
  final JOptionPane optionPane=new JOptionPane(panel,JOptionPane.PLAIN_MESSAGE,JOptionPane.YES_NO_OPTION,null,options,options[0]);
  final JDialog dialog=new JDialog(this,"Export Application",true);
  dialog.setContentPane(optionPane);
  optionPane.addPropertyChangeListener(new PropertyChangeListener(){
    public void propertyChange(    PropertyChangeEvent e){
      String prop=e.getPropertyName();
      if (dialog.isVisible() && (e.getSource() == optionPane) && (prop.equals(JOptionPane.VALUE_PROPERTY))) {
        dialog.setVisible(false);
      }
    }
  }
);
  dialog.pack();
  dialog.setResizable(false);
  Rectangle bounds=getBounds();
  dialog.setLocation(bounds.x + (bounds.width - dialog.getSize().width) / 2,bounds.y + (bounds.height - dialog.getSize().height) / 2);
  dialog.setVisible(true);
  Object value=optionPane.getValue();
  if (value.equals(options[0])) {
    return jmode.handleExportApplication(sketch);
  }
 else   if (value.equals(options[1]) || value.equals(new Integer(-1))) {
    statusNotice("Export to Application canceled.");
  }
  return false;
}
