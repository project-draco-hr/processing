{
  if ((pixels == null) || (pixels.length != width * height)) {
    pixels=new int[width * height];
  }
  int size=glWidth * glHeight;
  if (tmpFbo == null) {
    tmpFbo=new PFramebuffer(parent,glWidth,glHeight);
  }
  if (PGraphicsAndroid3D.fboSupported) {
    tmpFbo.setColorBuffer(this);
    a3d.pushFramebuffer();
    a3d.setFramebuffer(tmpFbo);
    tmpFbo.readPixels();
    a3d.popFramebuffer();
  }
 else {
    a3d.pushFramebuffer();
    a3d.setFramebuffer(tmpFbo);
    a3d.drawTexture(this,0,0,glWidth,glHeight,0,0,glWidth,glHeight);
    tmpFbo.readPixels();
    a3d.popFramebuffer();
  }
  if (tmpPixels == null) {
    tmpPixels=new int[size];
  }
  tmpFbo.getPixels(tmpPixels);
  convertToARGB(tmpPixels,pixels);
  if (flippedX)   flipArrayOnX(pixels,1);
  if (flippedY)   flipArrayOnY(pixels,1);
}
