{
  if ((pixels == null) || (pixels.length != width * height)) {
    pixels=new int[width * height];
  }
  int size=glWidth * glHeight;
  int[] tmp=new int[size];
  IntBuffer pixelBuffer=BufferUtil.newIntBuffer(size);
  PFramebuffer fbo=new PFramebuffer(parent,glWidth,glHeight);
  fbo.setColorBuffer(this);
  a3d.pushFramebuffer();
  a3d.setFramebuffer(fbo);
  gl.glReadPixels(0,0,glWidth,glHeight,GL10.GL_RGBA,GL10.GL_UNSIGNED_BYTE,pixelBuffer);
  a3d.popFramebuffer();
  pixelBuffer.get(tmp);
  pixelBuffer.rewind();
  convertToARGB(tmp,pixels);
  if (flippedX)   flipArrayOnX(pixels,1);
  if (flippedY)   flipArrayOnY(pixels,1);
}
