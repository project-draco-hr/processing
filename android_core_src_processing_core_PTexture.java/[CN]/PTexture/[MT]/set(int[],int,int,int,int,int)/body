{
  if (pixels == null) {
    throw new RuntimeException("PTexture: null pixels array");
  }
  if (pixels.length != width * height) {
    throw new RuntimeException("PTexture: wrong length of pixels array");
  }
  if (glID == 0) {
    createTexture(width,height);
  }
  gl.glEnable(glTarget);
  gl.glBindTexture(glTarget,glID);
  if (usingMipmaps) {
    if (a3d.gl11 != null && PGraphicsAndroid3D.mipmapSupported) {
      int[] rgbaPixels=new int[glWidth * glHeight];
      convertToRGBA(pixels,rgbaPixels,format,0,0,width,height);
      gl.glTexParameterf(GL11.GL_TEXTURE_2D,GL11.GL_GENERATE_MIPMAP,GL11.GL_TRUE);
      gl.glTexSubImage2D(glTarget,0,x,y,w,h,GL10.GL_RGBA,GL10.GL_UNSIGNED_BYTE,IntBuffer.wrap(rgbaPixels));
    }
 else {
      int[] rgbaPixels=new int[glWidth * glHeight];
      convertToRGBA(pixels,rgbaPixels,format,0,0,width,height);
      gl.glTexSubImage2D(glTarget,0,x,y,w,h,GL10.GL_RGBA,GL10.GL_UNSIGNED_BYTE,IntBuffer.wrap(rgbaPixels));
    }
  }
 else {
    int[] rgbaPixels=new int[glWidth * glHeight];
    convertToRGBA(pixels,rgbaPixels,format,0,0,width,height);
    gl.glTexSubImage2D(glTarget,0,x,y,w,h,GL10.GL_RGBA,GL10.GL_UNSIGNED_BYTE,IntBuffer.wrap(rgbaPixels));
  }
  gl.glDisable(glTarget);
}
