{
  if (sketch == null) {
    return;
  }
  sketch.ensureExistence();
  File sketchFolder=sketch.getFolder();
  File[] sketchFiles=sketchFolder.listFiles(new FilenameFilter(){
    @Override public boolean accept(    File dir,    String name){
      for (      String s : editor.getMode().getExtensions()) {
        if (name.toLowerCase().endsWith(s.toLowerCase())) {
          return true;
        }
      }
      return false;
    }
  }
);
  int fileCount=sketchFiles.length;
  if (fileCount != sketch.getCodeCount()) {
    if (reloadCode(null) && fileCount < 1) {
      try {
        sketch.getMainFile().createNewFile();
      }
 catch (      Exception e1) {
        showErrorEDT("Reload failed","The sketch contains no code files.",e1);
        return;
      }
      sketch.reload();
      showWarningEDT("Modified Reload","You cannot delete the last code file in a sketch.\n" + "A new blank sketch file has been generated for you.");
    }
    return;
  }
  List<SketchCode> reloadList=new ArrayList<>();
  for (  SketchCode code : sketch.getCode()) {
    File sketchFile=code.getFile();
    if (sketchFile.exists()) {
      long diff=sketchFile.lastModified() - code.getLastModified();
      if (diff > MODIFICATION_WINDOW_MILLIS) {
        if (DEBUG)         System.out.println(sketchFile.getName() + " " + diff+ "ms");
        reloadList.add(code);
      }
    }
 else {
      if (DEBUG)       System.out.println(sketchFile.getName() + " (file disappeared)");
      reloadList.add(code);
    }
  }
  if (reloadList.size() > 0) {
    reloadCode(reloadList);
  }
}
