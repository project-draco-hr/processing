{
  int pivot=right;
  do {
    while (compare(++left,pivot) < 0)     ;
    while ((right != 0) && (compare(--right,pivot) > 0))     ;
    swap(left,right);
  }
 while (left < right);
  swap(left,right);
  return left;
}
