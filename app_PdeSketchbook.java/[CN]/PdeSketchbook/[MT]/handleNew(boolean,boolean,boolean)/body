{
  File newbieDir=null;
  String newbieName=null;
  boolean prompt=PdePreferences.getBoolean("sketchbook.prompt");
  if (shift)   prompt=!prompt;
  if (startup)   prompt=false;
  if (prompt) {
    FileDialog fd=new FileDialog(editor,"Create sketch folder named:",FileDialog.SAVE);
    fd.setDirectory(PdePreferences.get("sketchbook.path"));
    fd.show();
    String newbieParentDir=fd.getDirectory();
    newbieName=fd.getFile();
    if (newbieName == null)     return null;
    newbieName=sanitizeName(newbieName);
    newbieDir=new File(newbieParentDir,newbieName);
  }
 else {
    String newbieParentDir=PdePreferences.get("sketchbook.path");
    int index=0;
    SimpleDateFormat formatter=new SimpleDateFormat("yyMMdd");
    String purty=formatter.format(new Date());
    do {
      newbieName="sketch_" + purty + ((char)('a' + index));
      newbieDir=new File(newbieParentDir,newbieName);
      index++;
    }
 while (newbieDir.exists());
  }
  newbieDir.mkdirs();
  if (library) {
    new File(newbieDir,"library").mkdirs();
  }
  File newbieFile=new File(newbieDir,newbieName + ".pde");
  new FileOutputStream(newbieFile);
  if ((PdeBase.platform == PdeBase.MACOS9) || (PdeBase.platform == PdeBase.MACOSX)) {
    MRJFileUtils.setFileTypeAndCreator(newbieFile,MRJOSType.kTypeTEXT,new MRJOSType("Pde1"));
  }
  rebuildMenu();
  return newbieFile.getAbsolutePath();
}
