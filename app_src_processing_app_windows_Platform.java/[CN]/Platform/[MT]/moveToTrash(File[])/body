{
  Shell32 shell=Shell32.INSTANCE;
  SHFILEOPSTRUCT fileop=new SHFILEOPSTRUCT();
  fileop.wFunc=ShellAPI.FO_DELETE;
  String[] paths=new String[files.length];
  for (int i=0; i < paths.length; i++) {
    paths[i]=files[i].getAbsolutePath();
    System.out.println(paths[i]);
  }
  fileop.pFrom=new WString(fileop.encodePaths(paths));
  fileop.fFlags=ShellAPI.FOF_ALLOWUNDO | ShellAPI.FOF_NO_UI;
  int ret=shell.SHFileOperation(fileop);
  if (ret != 0) {
    throw new IOException("Move to trash failed: " + fileop.pFrom + ": error code "+ ret);
  }
  if (fileop.fAnyOperationsAborted) {
    throw new IOException("Move to trash aborted");
  }
  return true;
}
