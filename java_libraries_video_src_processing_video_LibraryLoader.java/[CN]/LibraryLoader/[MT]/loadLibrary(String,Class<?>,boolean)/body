{
  String[] nameFormats;
  nameFormats=Platform.isWindows() ? new String[]{"lib%s","lib%s-0","%s"} : new String[]{"%s-0","%s"};
  UnsatisfiedLinkError linkError=null;
  for (  String fmt : nameFormats) {
    try {
      String s=String.format(fmt,name);
      Object obj=Native.loadLibrary(s,clazz);
      return obj;
    }
 catch (    UnsatisfiedLinkError ex) {
      linkError=ex;
    }
  }
  if (reqLib)   throw new UnsatisfiedLinkError(String.format("can't load library %s (%1$s|lib%1$s|lib%1$s-0) with -Djna.library.path=%s. Last error:%s",name,System.getProperty("jna.library.path"),linkError));
 else {
    System.out.println(String.format("can't load library %s (%1$s|lib%1$s|lib%1$s-0) with -Djna.library.path=%s. Last error:%s",name,System.getProperty("jna.library.path"),linkError));
    return null;
  }
}
