{
  if (editor.hasJavaTabs())   return;
  log("Last clicked word:" + lastClickedWord);
  if (lastClickedWord == null && getSelectedText() == null) {
    editor.statusMessage("Highlight the class/function/variable name first",EditorStatus.NOTICE);
    return;
  }
  if (errorCheckerService.hasSyntaxErrors()) {
    editor.statusMessage("Can't perform action until syntax errors are fixed :(",EditorStatus.WARNING);
    return;
  }
  DefaultMutableTreeNode defCU=findAllOccurrences();
  String selText=lastClickedWord == null ? getSelectedText() : lastClickedWord;
  if (defCU == null) {
    editor.statusMessage(selText + " isn't defined in this sketch, " + "so it cannot be renamed",EditorStatus.ERROR);
    return;
  }
  if (!renameWindow.isVisible()) {
    renameWindow.setLocation(editor.getX() + (editor.getWidth() - renameWindow.getWidth()) / 2,editor.getY() + (editor.getHeight() - renameWindow.getHeight()) / 2);
    renameWindow.setVisible(true);
    EventQueue.invokeLater(new Runnable(){
      @Override public void run(){
        String selText=lastClickedWord == null ? getSelectedText() : lastClickedWord;
        showUsageWindow.setTitle("All occurrences of " + selText);
        renameOldNameLabel.setText("Current name: " + selText);
        renameTextField.setText("");
        renameTextField.requestFocus();
      }
    }
);
  }
  renameWindow.toFront();
}
