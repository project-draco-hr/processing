{
  if (cu == null) {
    ASTParser parser=ASTParser.newParser(AST.JLS8);
    parser.setSource(source.toCharArray());
    parser.setKind(ASTParser.K_COMPILATION_UNIT);
    Map<String,String> options=JavaCore.getOptions();
    JavaCore.setComplianceOptions(JavaCore.VERSION_1_7,options);
    parser.setCompilerOptions(options);
    compilationUnit=(CompilationUnit)parser.createAST(null);
  }
 else {
    compilationUnit=cu;
  }
  getCodeComments();
  codeTree=new DefaultMutableTreeNode(new ASTNodeWrapper((ASTNode)compilationUnit.types().get(0)));
  if (compilationUnit.types() == null || compilationUnit.types().isEmpty()) {
    Messages.loge("No CU found!");
  }
  visitRecur((ASTNode)compilationUnit.types().get(0),codeTree);
  if (SHOW_DEBUG_TREE) {
    EventQueue.invokeLater(new Runnable(){
      @Override public void run(){
        updateDebugTree(codeTree);
      }
    }
);
  }
  return codeTree;
}
