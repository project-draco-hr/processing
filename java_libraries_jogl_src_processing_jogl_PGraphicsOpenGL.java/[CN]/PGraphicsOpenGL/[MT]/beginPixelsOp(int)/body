{
  FrameBuffer pixfb=null;
  if (primarySurface) {
    if (op == OP_READ) {
      if (pgl.isFBOBacked() && pgl.isMultisampled()) {
        pgl.syncBackTexture();
        pixfb=readFramebuffer;
      }
 else {
        pixfb=drawFramebuffer;
      }
    }
 else     if (op == OP_WRITE) {
      pixfb=drawFramebuffer;
    }
  }
 else {
    if (op == OP_READ) {
      if (offscreenMultisample) {
        multisampleFramebuffer.copyColor(offscreenFramebuffer);
      }
      pixfb=offscreenFramebuffer;
    }
 else     if (op == OP_WRITE) {
      pixfb=offscreenMultisample ? multisampleFramebuffer : offscreenFramebuffer;
    }
  }
  if (pixfb != getCurrentFB()) {
    pushFramebuffer();
    setFramebuffer(pixfb);
    pixOpChangedFB=true;
  }
  if (op == OP_READ) {
    pgl.readBuffer(getCurrentFB().getDefaultDrawBuffer());
  }
 else   if (op == OP_WRITE) {
    pgl.drawBuffer(getCurrentFB().getDefaultDrawBuffer());
  }
  pixelsOp=op;
}
