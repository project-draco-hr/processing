{
  File sketchbookContribFolder=type.getSketchbookFolder();
  File tempFolder=null;
  try {
    tempFolder=Base.createTempFolder(type.toString(),"tmp",sketchbookContribFolder);
  }
 catch (  IOException e) {
    statusBar.setErrorMessage("Could not create a temporary folder to install.");
    return null;
  }
  unzip(contribArchive,tempFolder);
  File contribFolder=null;
  if (type.isCandidate(tempFolder)) {
    contribFolder=tempFolder;
  }
  if (contribFolder == null) {
    contribFolder=type.findCandidate(tempFolder);
  }
  InstalledContribution installedContrib=null;
  if (contribFolder == null) {
    statusBar.setErrorMessage("Could not find a " + type + " in the downloaded file.");
  }
 else {
    File propFile=new File(contribFolder,type + ".properties");
    if (!writePropertiesFile(propFile)) {
      InstalledContribution newContrib=type.load(editor.getBase(),contribFolder);
      installedContrib=newContrib.moveAndLoad(editor,confirmReplace,statusBar);
    }
 else {
      statusBar.setErrorMessage("Error overwriting .properties file.");
    }
  }
  if (tempFolder.exists()) {
    Base.removeDir(tempFolder);
  }
  return installedContrib;
}
