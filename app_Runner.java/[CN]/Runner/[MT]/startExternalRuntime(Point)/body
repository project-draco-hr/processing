{
  Point editorLocation=editor.getLocation();
  String location=(windowLocation != null) ? (PApplet.ARGS_LOCATION + "=" + windowLocation.x+ ","+ windowLocation.y) : (PApplet.ARGS_EDITOR_LOCATION + "=" + editorLocation.x+ ","+ editorLocation.y);
  String command[]=new String[]{"java","-Djava.library.path=" + sketch.libraryPath + File.pathSeparator+ System.getProperty("java.library.path"),"-cp",sketch.classPath + Sketchbook.librariesClassPath,"processing.core.PApplet",location,PApplet.ARGS_EXTERNAL,PApplet.ARGS_DISPLAY + "=" + Preferences.get("run.display"),PApplet.ARGS_SKETCH_FOLDER + "=" + sketch.folder.getAbsolutePath(),sketch.mainClassName};
  process=Runtime.getRuntime().exec(command);
  processInput=new SystemOutSiphon(process.getInputStream());
  processError=new MessageSiphon(process.getErrorStream(),this);
  processOutput=process.getOutputStream();
}
