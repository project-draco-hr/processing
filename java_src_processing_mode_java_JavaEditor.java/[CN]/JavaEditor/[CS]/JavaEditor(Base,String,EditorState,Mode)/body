{
  super(base,path,state,mode);
  jmode=(JavaMode)mode;
  debugger=new Debugger(this);
  inspector=new VariableInspector(this);
  JMenuItem showUsageItem=new JMenuItem("Show Usage...");
  showUsageItem.addActionListener(new ActionListener(){
    public void actionPerformed(    ActionEvent e){
      handleShowUsage();
    }
  }
);
  getTextArea().getRightClickPopup().add(showUsageItem);
  JMenuItem renameItem=new JMenuItem("Rename...");
  renameItem.addActionListener(new ActionListener(){
    public void actionPerformed(    ActionEvent e){
      handleRefactor();
    }
  }
);
  textarea.getRightClickPopup().add(renameItem);
  Toolkit.setMenuMnemonics(textarea.getRightClickPopup());
  breakpointColor=mode.getColor("breakpoint.bgcolor");
  breakpointMarkerColor=mode.getColor("breakpoint.marker.color");
  currentLineColor=mode.getColor("currentline.bgcolor");
  currentLineMarkerColor=mode.getColor("currentline.marker.color");
  for (  LineID lineID : stripBreakpointComments()) {
    debugger.setBreakpoint(lineID);
  }
  getSketch().setModified(false);
  hasJavaTabs=checkForJavaTabs();
  errorCheckerService=new ErrorCheckerService(this);
  new Thread(errorCheckerService).start();
  getJavaTextArea().setECSandThemeforTextArea(errorCheckerService,jmode);
  JPanel textAndError=new JPanel();
  textAndError.setLayout(new BorderLayout());
  errorBar=new ErrorBar(this,textarea.getMinimumSize().height,jmode);
  textAndError.add(errorBar,BorderLayout.EAST);
  textarea.setBounds(0,0,errorBar.getX() - 1,textarea.getHeight());
  textAndError.add(textarea);
  errorTableScrollPane=new JScrollPane();
  errorTable=new XQErrorTable(errorCheckerService);
  errorTableScrollPane.setBorder(new EtchedBorder());
  errorTableScrollPane.setViewportView(errorTable);
  JPanel lineStatusPanel=new JPanel();
  lineStatusPanel.setLayout(new BorderLayout());
  btnShowConsole=new XQConsoleToggle(this,Language.text("editor.footer.console"),lineStatus.getHeight());
  btnShowErrors=new XQConsoleToggle(this,Language.text("editor.footer.errors"),lineStatus.getHeight());
  btnShowConsole.addMouseListener(btnShowConsole);
  btnShowErrors.addMouseListener(btnShowErrors);
  JPanel toggleButtonPanel=new JPanel(new BorderLayout());
  toggleButtonPanel.add(btnShowConsole,BorderLayout.EAST);
  toggleButtonPanel.add(btnShowErrors,BorderLayout.WEST);
  lineStatusPanel.add(toggleButtonPanel,BorderLayout.EAST);
  lineStatus.setBounds(0,0,toggleButtonPanel.getX() - 1,toggleButtonPanel.getHeight());
  lineStatusPanel.add(lineStatus);
  lineStatusPanel.repaint();
  consoleProblemsPane=new JPanel(new CardLayout());
  consoleProblemsPane.add(errorTableScrollPane,Language.text("editor.footer.errors"));
  consoleProblemsPane.add(console,Language.text("editor.footer.console"));
  addWindowFocusListener(new WindowFocusListener(){
    public void windowLostFocus(    WindowEvent e){
      getJavaTextArea().hideSuggestion();
    }
    public void windowGainedFocus(    WindowEvent e){
    }
  }
);
}
