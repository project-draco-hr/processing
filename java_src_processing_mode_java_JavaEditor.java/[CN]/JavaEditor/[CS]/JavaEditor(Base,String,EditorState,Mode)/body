{
  super(base,path,state,mode);
  jmode=(JavaMode)mode;
  debugger=new Debugger(this);
  tray=new DebugTray(this);
  JMenuItem showUsageItem=new JMenuItem("Show Usage...");
  showUsageItem.addActionListener(new ActionListener(){
    public void actionPerformed(    ActionEvent e){
      handleShowUsage();
    }
  }
);
  getTextArea().getRightClickPopup().add(showUsageItem);
  JMenuItem renameItem=new JMenuItem("Rename...");
  renameItem.addActionListener(new ActionListener(){
    public void actionPerformed(    ActionEvent e){
      handleRefactor();
    }
  }
);
  textarea.getRightClickPopup().add(renameItem);
  Toolkit.setMenuMnemonics(textarea.getRightClickPopup());
  breakpointColor=mode.getColor("breakpoint.bgcolor");
  breakpointMarkerColor=mode.getColor("breakpoint.marker.color");
  currentLineColor=mode.getColor("currentline.bgcolor");
  currentLineMarkerColor=mode.getColor("currentline.marker.color");
  for (  LineID lineID : stripBreakpointComments()) {
    debugger.setBreakpoint(lineID);
  }
  getSketch().setModified(false);
  hasJavaTabs=checkForJavaTabs();
  initializeErrorChecker();
  getJavaTextArea().setECSandThemeforTextArea(errorCheckerService,jmode);
  addXQModeUI();
}
