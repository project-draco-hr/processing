{
  int[] colors=new int[gradient.count];
  int opacityMask=((int)(opacity * 255)) << 24;
  for (int i=0; i < gradient.count; i++) {
    colors[i]=opacityMask | (gradient.color[i] & 0xFFFFFF);
  }
  if (gradient instanceof LinearGradient) {
    LinearGradient grad=(LinearGradient)gradient;
    return new android.graphics.LinearGradient(grad.x1,grad.y1,grad.x2,grad.y2,colors,grad.offset,Shader.TileMode.CLAMP);
  }
 else   if (gradient instanceof RadialGradient) {
    RadialGradient grad=(RadialGradient)gradient;
    return new android.graphics.RadialGradient(grad.cx,grad.cy,grad.r,colors,grad.offset,Shader.TileMode.CLAMP);
  }
  return null;
}
