{
  vm.setDebugTraceMode(debugTraceMode);
  EventThread eventThread=null;
  if (writer != null) {
    eventThread=new EventThread(vm,excludes,writer);
    eventThread.setEventRequests(watchFields);
    eventThread.start();
  }
  Process process=vm.process();
  MessageSiphon ms=new MessageSiphon(process.getErrorStream(),this);
  errThread=ms.thread;
  outThread=new StreamRedirectThread("output reader",process.getInputStream(),System.out);
  errThread.start();
  outThread.start();
  vm.resume();
  try {
    if (eventThread != null)     eventThread.join();
    errThread.join();
    outThread.join();
    editor.handleStopped();
  }
 catch (  InterruptedException exc) {
  }
  if (writer != null)   writer.close();
}
