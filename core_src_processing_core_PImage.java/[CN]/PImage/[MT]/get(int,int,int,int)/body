{
  if (imageMode == CORNERS) {
    w=(w - x);
    h=(h - y);
  }
  if (x < 0) {
    w+=x;
    x=0;
  }
  if (y < 0) {
    h+=y;
    y=0;
  }
  if (x + w > width)   w=width - x;
  if (y + h > height)   h=height - y;
  PImage newbie=new PImage(w,h,format);
  newbie.parent=parent;
  int index=y * width + x;
  int index2=0;
  for (int row=y; row < y + h; row++) {
    System.arraycopy(pixels,index,newbie.pixels,index2,w);
    index+=width;
    index2+=w;
  }
  return newbie;
}
