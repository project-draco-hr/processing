{
  format=RGB;
  if (img instanceof BufferedImage) {
    BufferedImage bi=(BufferedImage)img;
    width=bi.getWidth();
    height=bi.getHeight();
    pixels=new int[width * height];
    pixels=((DataBufferInt)bi.getRaster().getDataBuffer()).getData();
    int type=bi.getType();
    if (type == BufferedImage.TYPE_INT_ARGB) {
      format=ARGB;
    }
 else     if (type == BufferedImage.TYPE_INT_RGB) {
      for (int i=0; i < pixels.length; i++) {
        pixels[i]=0xFF000000 | pixels[i];
      }
    }
  }
 else {
    width=img.getWidth(null);
    height=img.getHeight(null);
    pixels=new int[width * height];
    PixelGrabber pg=new PixelGrabber(img,0,0,width,height,pixels,0,width);
    try {
      pg.grabPixels();
    }
 catch (    InterruptedException e) {
    }
  }
  pixelDensity=1;
  pixelWidth=width;
  pixelHeight=height;
}
