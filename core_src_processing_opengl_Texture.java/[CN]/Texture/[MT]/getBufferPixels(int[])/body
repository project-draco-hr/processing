{
  boolean addToUsed=false;
  BufferData data=null;
  if (usedBuffers != null && 0 < usedBuffers.size()) {
    data=usedBuffers.getLast();
  }
 else   if (bufferCache != null && 0 < bufferCache.size()) {
    data=bufferCache.remove(0);
    addToUsed=true;
  }
  if (data != null) {
    if ((data.w != width) || (data.h != height)) {
      init(data.w,data.h);
    }
    data.rgbBuf.rewind();
    data.rgbBuf.get(pixels);
    convertToARGB(pixels);
    if (addToUsed) {
      if (usedBuffers == null) {
        usedBuffers=new LinkedList<BufferData>();
      }
      usedBuffers.add(data);
    }
  }
}
