{
  Advapi32 advapi32;
  IntByReference hkResult, dwDisposition;
  int handle=0;
  boolean ret=false;
  advapi32=Advapi32.INSTANCE;
  hkResult=new IntByReference();
  dwDisposition=new IntByReference();
  handle=openKey(rootKey,parent,WINNT.KEY_READ);
  if (handle != 0) {
    if (advapi32.RegCreateKeyEx(handle,name,0,null,WINNT.REG_OPTION_NON_VOLATILE,WINNT.KEY_READ,null,hkResult,dwDisposition) == WINERROR.ERROR_SUCCESS) {
      ret=true;
      advapi32.RegCloseKey(hkResult.getValue());
    }
 else {
      ret=false;
    }
    advapi32.RegCloseKey(handle);
  }
  return (ret);
}
