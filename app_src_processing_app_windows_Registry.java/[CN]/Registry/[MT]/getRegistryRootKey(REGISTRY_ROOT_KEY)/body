{
  Advapi32 advapi32;
  HKEYByReference pHandle;
  HKEY handle=null;
  advapi32=Advapi32.INSTANCE;
  pHandle=new WinReg.HKEYByReference();
  if (advapi32.RegOpenKeyEx(rootKeyMap.get(key),null,0,0,pHandle) == WinError.ERROR_SUCCESS) {
    handle=pHandle.getValue();
  }
  return handle;
}
