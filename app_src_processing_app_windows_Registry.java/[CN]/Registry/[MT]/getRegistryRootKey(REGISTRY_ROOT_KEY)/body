{
  Advapi32 advapi32;
  IntByReference pHandle;
  int handle=0;
  advapi32=Advapi32.INSTANCE;
  pHandle=new IntByReference();
  if (advapi32.RegOpenKeyEx(rootKeyMap.get(key),null,0,0,pHandle) == WINERROR.ERROR_SUCCESS) {
    handle=pHandle.getValue();
  }
  return (handle);
}
