{
  Advapi32 advapi32;
  int handle=0, dwIndex;
  char[] lpName;
  IntByReference lpcName;
  WINBASE.FILETIME lpftLastWriteTime;
  TreeSet<String> subKeys=new TreeSet<String>();
  advapi32=Advapi32.INSTANCE;
  handle=openKey(rootKey,parent,WINNT.KEY_READ);
  lpName=new char[256];
  lpcName=new IntByReference(256);
  lpftLastWriteTime=new WINBASE.FILETIME();
  if (handle != 0) {
    dwIndex=0;
    while (advapi32.RegEnumKeyEx(handle,dwIndex,lpName,lpcName,null,null,null,lpftLastWriteTime) == WINERROR.ERROR_SUCCESS) {
      subKeys.add(new String(lpName,0,lpcName.getValue()));
      lpcName.setValue(256);
      dwIndex++;
    }
    advapi32.RegCloseKey(handle);
  }
  return (subKeys.toArray(new String[]{}));
}
