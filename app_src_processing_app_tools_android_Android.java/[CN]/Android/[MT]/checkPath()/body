{
  Platform platform=Base.getPlatform();
  String envPath=platform.getenv("ANDROID_SDK");
  if (envPath != null) {
    sdkPath=envPath;
    Preferences.set("android.sdk.path",envPath);
  }
 else {
    sdkPath=Preferences.get("android.sdk.path");
    if (sdkPath == null) {
      int result=Base.showYesNoQuestion(editor,"Android SDK",ANDROID_SDK_PRIMARY,ANDROID_SDK_SECONDARY);
      if (result == JOptionPane.YES_OPTION) {
        File folder=Base.selectFolder(SELECT_ANDROID_SDK_FOLDER,null,editor);
        if (folder != null) {
          boolean basicCheck=false;
          if (Base.isWindows()) {
            basicCheck=(new File(folder,"tools/android.exe").exists() || new File(folder,"tools/android.bat").exists());
          }
 else {
            basicCheck=new File(folder,"tools/android").exists();
          }
          if (basicCheck) {
            sdkPath=folder.getAbsolutePath();
            Preferences.set("android.sdk.path",sdkPath);
          }
 else {
            System.err.println("Could not find the android executable at " + folder.getAbsolutePath() + "/tools/android");
            JOptionPane.showMessageDialog(editor,NOT_ANDROID_SDK);
            return false;
          }
        }
      }
 else       if (result == JOptionPane.NO_OPTION) {
        Base.openURL(ANDROID_SDK_URL);
      }
    }
  }
  if (sdkPath == null) {
    return false;
  }
  if (envPath == null) {
    platform.setenv("ANDROID_SDK",sdkPath);
  }
  String toolsPath=sdkPath + File.separator + "tools";
  String path=platform.getenv("PATH");
  System.out.println("path before set is " + path);
  platform.setenv("PATH",path + File.pathSeparator + toolsPath);
  System.out.println("path after set is " + Base.getPlatform().getenv("PATH"));
  try {
    PApplet.println(Device.list());
  }
 catch (  Exception e) {
    e.printStackTrace();
  }
  String[] cmd={"echo","$PATH"};
  try {
    Pavarotti p=new Pavarotti(cmd);
    int result=p.waitFor();
    if (result == 0) {
      PApplet.println(p.getOutputLines());
    }
  }
 catch (  Exception e) {
    e.printStackTrace();
  }
  return true;
}
