{
  try {
    String port=null;
    final long timeout=System.currentTimeMillis() + 15 * 1000;
    while (System.currentTimeMillis() < timeout) {
      if (port != null) {
        System.out.println("Waiting a half second " + "for the application to launch...");
        try {
          Thread.sleep(500);
        }
 catch (        final InterruptedException ie) {
        }
      }
      port=getJdwpPort(device);
      if (!port.equals(prevPort)) {
        break;
      }
    }
    System.out.println("Found application on port " + port + ".");
    final ProcessHelper fwd=new ProcessHelper("adb","-s",device,"forward","tcp:" + ADB_SOCKET_PORT,"jdwp:" + port);
    System.out.println(fwd.getCommand());
    if (fwd.execute(true) != 0) {
      editor.statusError("Could not connect for debugging.");
      return false;
    }
    System.out.println("creating runner");
    final AndroidRunner ar=new AndroidRunner(editor,editor.getSketch());
    return ar.launch(ADB_SOCKET_PORT);
  }
 catch (  final IOException e) {
    editor.statusError(e);
  }
catch (  final InterruptedException e) {
  }
  return false;
}
