{
  try {
    running=true;
    if (port < 0) {
      server=new ServerSocket(0);
      port=server.getLocalPort();
    }
 else {
      server=new ServerSocket(port);
    }
  }
 catch (  IOException ioe) {
    System.err.println(ioe);
  }
catch (  SecurityException se) {
    System.err.println(se);
  }
  try {
    if (server != null) {
      inited=true;
      if (listeners != null) {
        for (        BasicServerListener l : listeners) {
          l.serverStarted();
        }
      }
      while (thread != null) {
        Socket s=server.accept();
        Worker ws=new Worker(virtualRoot);
        ws.setSocket(s);
        (new Thread(ws,"Processing.BasicServer.Worker")).start();
      }
    }
 else {
      System.err.println("Server is null. Bad. Really.");
    }
  }
 catch (  IOException ioe) {
  }
  running=false;
}
