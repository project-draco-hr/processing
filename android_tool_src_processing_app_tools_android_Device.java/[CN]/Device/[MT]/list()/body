{
  try {
    final ProcessResult result=LIST_DEVICES_CMD.execute();
    if (!result.succeeded()) {
      System.err.println(result);
      return null;
    }
    final String[] lines=result.getStdout().split("\r?\n");
    if (lines.length == 0) {
      return new String[]{};
    }
    int startIndex=0;
    if (lines[startIndex].startsWith("* daemon not running. starting it now *")) {
      startIndex++;
    }
    if (lines[startIndex].startsWith("* daemon started successfully *")) {
      startIndex++;
    }
    if (!lines[startIndex].startsWith("List of devices")) {
      Base.showWarning("Android Error",ADB_DEVICES_ERROR,null);
    }
    startIndex++;
    String[] devices=new String[lines.length - startIndex];
    int deviceIndex=0;
    for (int i=startIndex; i < lines.length; i++) {
      final String line=lines[i];
      final int tab=line.indexOf('\t');
      if (tab != -1) {
        devices[deviceIndex++]=line.substring(0,tab);
      }
 else       if (line.trim().length() != 0) {
        System.out.println("Unknown ???adb devices??? response: " + line);
      }
    }
    devices=PApplet.subset(devices,0,deviceIndex);
    return devices;
  }
 catch (  final InterruptedException ie) {
  }
  return null;
}
