{
  try {
    OutputStream os=null;
    if (filename.toLowerCase().endsWith(".tga")) {
      os=new BufferedOutputStream(new FileOutputStream(filename),32768);
      saveTGA(os,pixels,width,height);
    }
 else {
      if (!filename.toLowerCase().endsWith(".tif") && !filename.toLowerCase().endsWith(".tiff")) {
        filename+=".tif";
      }
      os=new BufferedOutputStream(new FileOutputStream(filename),32768);
      saveTIFF(os,pixels,width,height);
    }
    os.flush();
    os.close();
  }
 catch (  IOException e) {
    e.printStackTrace();
  }
}
