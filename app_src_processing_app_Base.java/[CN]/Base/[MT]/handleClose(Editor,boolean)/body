{
  if (!editor.checkModified(quitting)) {
    return false;
  }
  if (quitting) {
    return true;
  }
  editor.closeRunner();
  if (editorCount == 1) {
    if (Preferences.getBoolean("sketchbook.closing_last_window_quits")) {
      editorCount=0;
      storeSketches();
      Preferences.save();
      System.exit(0);
    }
 else {
      try {
        String path=createNewUntitled();
        activeEditor.handleOpenInternal(path);
        return true;
      }
 catch (      IOException e) {
        e.printStackTrace();
        return false;
      }
    }
  }
 else {
    editor.setVisible(false);
    editor.dispose();
    for (int i=0; i < editorCount; i++) {
      if (editor == editors[i]) {
        for (int j=i; j < editorCount - 1; j++) {
          editors[j]=editors[j + 1];
        }
        editorCount--;
        editors[editorCount]=null;
      }
    }
  }
  return true;
}
