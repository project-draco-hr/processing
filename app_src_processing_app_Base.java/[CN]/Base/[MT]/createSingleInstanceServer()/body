{
  try {
    final ServerSocket ss=new ServerSocket(0,0,InetAddress.getByName(null));
    Preferences.set("server.port","" + ss.getLocalPort());
    final String key="" + Math.random();
    Preferences.set("server.key",key);
    Preferences.save();
    new Thread(new Runnable(){
      public void run(){
        while (true) {
          try {
            Socket s=ss.accept();
            BufferedReader br=new BufferedReader(new InputStreamReader(s.getInputStream()));
            String receivedKey=br.readLine();
            if (key.equals(receivedKey)) {
              String filename=br.readLine();
              if (filename != null) {
                platform.base.handleOpen(filename);
              }
 else {
                platform.base.handleNew();
              }
            }
          }
 catch (          IOException e) {
          }
        }
      }
    }
).start();
  }
 catch (  IOException e) {
  }
}
