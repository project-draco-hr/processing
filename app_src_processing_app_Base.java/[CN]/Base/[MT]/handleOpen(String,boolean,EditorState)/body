{
  final File file=new File(path);
  if (!file.exists()) {
    return null;
  }
  for (  Editor editor : editors) {
    if (editor.getSketch().getMainFile().equals(file)) {
      editor.toFront();
      handleRecent(editor);
      return editor;
    }
  }
  if (!Sketch.isSanitaryName(file.getName())) {
    Base.showWarning("You're tricky, but not tricky enough",file.getName() + " is not a valid name for a sketch.\n" + "Better to stick to ASCII, no spaces, and make sure\n"+ "it doesn't start with a number.",null);
    return null;
  }
  if (!nextMode.canEdit(file)) {
    final Mode mode=selectMode(file);
    if (mode == null) {
      return null;
    }
    nextMode=mode;
  }
  Editor editor=nextMode.createEditor(this,path,state);
  if (editor == null) {
    if (nextMode == coreModes[0]) {
      Base.showError("Editor Problems","An error occurred while trying to change modes.\n" + "We'll have to quit for now because it's an\n" + "unfortunate bit of indigestion.",null);
    }
 else {
      editor=coreModes[0].createEditor(this,path,state);
    }
  }
  if (editor.getSketch() == null) {
    return null;
  }
  editor.getSketch().setUntitled(untitled);
  editors.add(editor);
  handleRecent(editor);
  editor.setVisible(true);
  return editor;
}
