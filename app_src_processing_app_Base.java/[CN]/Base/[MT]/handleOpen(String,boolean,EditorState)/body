{
  try {
    final File file=new File(path);
    if (!file.exists()) {
      return null;
    }
    for (    Editor editor : editors) {
      for (      SketchCode tab : editor.getSketch().getCode()) {
        if (tab.getFile().equals(file)) {
          editor.toFront();
          handleRecent(editor);
          return editor;
        }
      }
    }
    if (!Sketch.isSanitaryName(file.getName())) {
      Base.showWarning("You're tricky, but not tricky enough",file.getName() + " is not a valid name for a sketch.\n" + "Better to stick to ASCII, no spaces, and make sure\n"+ "it doesn't start with a number.",null);
      return null;
    }
    if (!nextMode.canEdit(file)) {
      final Mode mode=selectMode(file);
      if (mode == null) {
        return null;
      }
      nextMode=mode;
    }
    Editor editor=nextMode.createEditor(this,path,state);
    if (editor == null) {
      Mode defaultMode=getDefaultMode();
      if (nextMode == defaultMode) {
        Base.showError("Editor Problems","An error occurred while trying to change modes.\n" + "We'll have to quit for now because it's an\n" + "unfortunate bit of indigestion.",null);
      }
 else {
        editor=defaultMode.createEditor(this,path,state);
      }
    }
    Sketch sketch=editor.getSketch();
    if (sketch == null) {
      return null;
    }
    sketch.setUntitled(untitled);
    editors.add(editor);
    handleRecent(editor);
    editor.setVisible(true);
    return editor;
  }
 catch (  Throwable t) {
    showBadnessTrace("Terrible News","A serious error occurred while " + "trying to create a new editor window.",t,false);
    nextMode=getDefaultMode();
    return null;
  }
}
