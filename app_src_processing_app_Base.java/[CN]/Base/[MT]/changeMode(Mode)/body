{
  if (activeEditor.getMode() != mode) {
    Sketch sketch=activeEditor.getSketch();
    if (sketch.isModified()) {
      Base.showWarning("Save","Please save the sketch before changing the mode.",null);
    }
 else {
      if (sketch.isUntitled()) {
        handleClose(activeEditor,true);
      }
      nextMode=mode;
      handleNew();
    }
  }
}
