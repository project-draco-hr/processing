{
  ArrayList<String> params=new ArrayList<String>();
  if (build.getFoundMain()) {
    params.add(build.getSketchClassName());
  }
 else {
    params.add("processing.core.PApplet");
    int runDisplay=Preferences.getInteger("run.display") - 1;
    if (editor != null) {
      GraphicsDevice editorDevice=editor.getGraphicsConfiguration().getDevice();
      GraphicsEnvironment ge=GraphicsEnvironment.getLocalGraphicsEnvironment();
      GraphicsDevice[] devices=ge.getScreenDevices();
      GraphicsDevice runDevice=(runDisplay >= 0 && runDisplay < devices.length) ? devices[runDisplay] : editorDevice;
      Point windowLocation=editor.getSketchLocation();
      if (windowLocation == null) {
        if (editorDevice == runDevice) {
          Point editorLocation=editor.getLocation();
          params.add(PApplet.ARGS_EDITOR_LOCATION + "=" + editorLocation.x+ ","+ editorLocation.y);
        }
 else {
        }
      }
 else {
        params.add(PApplet.ARGS_LOCATION + "=" + windowLocation.x+ ","+ windowLocation.y);
      }
      params.add(PApplet.ARGS_EXTERNAL);
    }
    params.add(PApplet.ARGS_DISPLAY + "=" + runDisplay);
    params.add(PApplet.ARGS_SKETCH_FOLDER + "=" + build.getSketchPath());
    if (presenting) {
      params.add(PApplet.ARGS_FULL_SCREEN);
      params.add(PApplet.ARGS_STOP_COLOR + "=" + Preferences.get("run.present.stop.color"));
      params.add(PApplet.ARGS_BGCOLOR + "=" + Preferences.get("run.present.bgcolor"));
    }
    params.add(build.getSketchClassName());
  }
  return (String[])params.toArray(new String[0]);
}
