{
  if (lights) {
    if (!lightingDependsOnVertexPosition && normalMode == NORMAL_MODE_SHAPE) {
      calcLightingContribution(shapeFirst,tempLightingContribution);
      for (int tri=0; tri < triangleCount; tri++) {
        lightTriangle(tri,tempLightingContribution);
      }
    }
 else {
      for (int tri=0; tri < triangleCount; tri++) {
        lightTriangle(tri);
      }
    }
  }
 else {
    for (int tri=0; tri < triangleCount; tri++) {
      int index=triangles[tri][VERTEX1];
      copyPrelitVertexColor(tri,index,0);
      index=triangles[tri][VERTEX2];
      copyPrelitVertexColor(tri,index,1);
      index=triangles[tri][VERTEX3];
      copyPrelitVertexColor(tri,index,2);
    }
  }
}
