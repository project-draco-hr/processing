{
  float[] triColor=triangleColors[triIndex][colorIndex];
  float[] v=vertices[vIndex];
  triColor[TRI_DIFFUSE_R]=clamp(v[ER] + v[AR] * lightContribution[LIGHT_AMBIENT_R] + v[DR] * lightContribution[LIGHT_DIFFUSE_R]);
  triColor[TRI_DIFFUSE_G]=clamp(v[EG] + v[AG] * lightContribution[LIGHT_AMBIENT_G] + v[DG] * lightContribution[LIGHT_DIFFUSE_G]);
  triColor[TRI_DIFFUSE_B]=clamp(v[EB] + v[AB] * lightContribution[LIGHT_AMBIENT_B] + v[DB] * lightContribution[LIGHT_DIFFUSE_B]);
  triColor[TRI_DIFFUSE_A]=clamp(v[DA]);
  triColor[TRI_SPECULAR_R]=clamp(v[SPR] * lightContribution[LIGHT_SPECULAR_R]);
  triColor[TRI_SPECULAR_G]=clamp(v[SPG] * lightContribution[LIGHT_SPECULAR_G]);
  triColor[TRI_SPECULAR_B]=clamp(v[SPB] * lightContribution[LIGHT_SPECULAR_B]);
}
