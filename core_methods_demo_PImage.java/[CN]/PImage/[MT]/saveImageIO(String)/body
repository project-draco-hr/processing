{
  try {
    BufferedImage bimage=new BufferedImage(width,height,(format == ARGB) ? BufferedImage.TYPE_INT_ARGB : BufferedImage.TYPE_INT_RGB);
    bimage.setRGB(0,0,width,height,pixels,0,width);
    File file=new File(path);
    String extension=path.substring(path.lastIndexOf('.') + 1);
    ImageIO.write(bimage,extension,file);
  }
 catch (  Exception e) {
    e.printStackTrace();
    throw new IOException("image save failed.");
  }
}
