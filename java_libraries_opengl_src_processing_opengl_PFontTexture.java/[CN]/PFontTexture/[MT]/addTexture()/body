{
  int w, h;
  boolean resize;
  w=maxTexWidth;
  if (-1 < currentTex && textures[currentTex].glHeight < maxTexHeight) {
    h=PApplet.min(2 * textures[currentTex].glHeight,maxTexHeight);
    resize=true;
  }
 else {
    h=PApplet.min(PGraphicsOpenGL.maxTextureSize,512,maxTexHeight / 4);
    resize=false;
  }
  PTexture tex=new PTexture(parent,w,h,new PTexture.Parameters(ARGB,BILINEAR));
  if (textures == null) {
    textures=new PTexture[1];
    textures[0]=tex;
    images=new PImage[1];
    images[0]=PTexture.wrap(ogl,tex);
    currentTex=0;
  }
 else   if (resize) {
    PTexture tex0=textures[currentTex];
    tex.put(tex0);
    textures[currentTex]=tex;
    images[currentTex].setCache(ogl,tex);
    images[currentTex].width=tex.width;
    images[currentTex].height=tex.height;
  }
 else {
    PTexture[] tempTex=textures;
    textures=new PTexture[textures.length + 1];
    PApplet.arrayCopy(tempTex,textures,tempTex.length);
    textures[tempTex.length]=tex;
    currentTex=textures.length - 1;
    PImage[] tempImg=images;
    images=new PImage[textures.length + 1];
    PApplet.arrayCopy(tempImg,images,tempImg.length);
    images[tempImg.length]=PTexture.wrap(ogl,tex);
  }
  lastTex=currentTex;
  tex.bind();
  return resize;
}
