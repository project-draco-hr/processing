{
  float val, sum=0;
  float v[]={x,y,z};
  float nscale=1;
  for (int i=0; i < n; i++) {
    val=noise3(v);
    sum+=val / nscale;
    nscale*=nalpha;
    v[0]*=nbeta;
    v[1]*=nbeta;
    v[2]*=nbeta;
  }
  return sum;
}
