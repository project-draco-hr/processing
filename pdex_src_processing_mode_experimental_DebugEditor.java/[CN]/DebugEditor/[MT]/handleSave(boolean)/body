{
  log("handleSave, viewing autosave? " + viewingAutosaveBackup);
  if (viewingAutosaveBackup) {
    File files[]=autosaver.getSketchBackupFolder().listFiles();
    File src=autosaver.getSketchBackupFolder(), dst=autosaver.getSketchFolder();
    for (    File f : files) {
      log("Copying " + f.getAbsolutePath() + " to "+ dst.getAbsolutePath());
    }
  }
  final List<String> modified=new ArrayList();
  for (int i=0; i < getSketch().getCodeCount(); i++) {
    SketchCode tab=getSketch().getCode(i);
    if (tab.isModified()) {
      modified.add(tab.getFileName());
    }
  }
  boolean saved=super.handleSave(immediately);
  if (saved) {
    if (immediately) {
      for (      String tabFilename : modified) {
        addBreakpointComments(tabFilename);
      }
    }
 else {
      EventQueue.invokeLater(new Runnable(){
        @Override public void run(){
          for (          String tabFilename : modified) {
            addBreakpointComments(tabFilename);
          }
        }
      }
);
    }
  }
  autosaver.reloadAutosaveDir();
  return saved;
}
