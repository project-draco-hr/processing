{
  tweakClient.shutdown();
  ta.stopInteractiveMode();
  removeSpacesFromCode();
  boolean modified=false;
  boolean[] modifiedTabs=getModifiedTabs(handles);
  for (  boolean mod : modifiedTabs) {
    if (mod) {
      modified=true;
      break;
    }
  }
  if (modified) {
    int ret=Base.showYesNoQuestion(this,"Tweak Mode","Keep the changes?","You changed some values in your sketch. Would you like to keep the changes?");
    if (ret == 1) {
      loadSavedCode();
      ta.invalidate();
    }
 else {
      for (int i=0; i < sketch.getCodeCount(); i++) {
        if (modifiedTabs[i]) {
          sketch.getCode(i).setModified(true);
        }
 else {
          sketch.getCode(i).setProgram(sketch.getCode(i).getSavedProgram());
          sketch.getCode(i).setDocument(null);
          if (i == sketch.getCurrentCodeIndex()) {
            setCode(sketch.getCurrentCode());
          }
        }
      }
      try {
        sketch.save();
      }
 catch (      IOException e) {
        Base.showWarning("Tweak Mode","Could not save the modified sketch!",e);
      }
      header.repaint();
      ta.invalidate();
    }
  }
 else {
    loadSavedCode();
    ta.invalidate();
  }
}
