{
  File tempFolder=null;
  try {
    tempFolder=type.createTempFolder();
  }
 catch (  IOException e) {
    status.setErrorMessage("Could not create a temporary folder to install.");
    return null;
  }
  Base.unzip(contribArchive,tempFolder);
  File contribFolder=null;
  if (type.isCandidate(tempFolder)) {
    status.setErrorMessage(getName() + " needs to be repackaged according to the " + type.getTitle()+ " guidelines.");
    return null;
  }
  contribFolder=type.findCandidate(tempFolder);
  LocalContribution installedContrib=null;
  if (contribFolder == null) {
    status.setErrorMessage("Could not find a " + type + " in the downloaded file.");
  }
 else {
    File propFile=new File(contribFolder,type + ".properties");
    if (writePropertiesFile(propFile)) {
      LocalContribution newContrib=type.load(base,contribFolder);
      File newContribFolder=newContrib.getFolder();
      installedContrib=newContrib.copyAndLoadOnStartup(base,status);
      newContrib=null;
      System.gc();
      if (Base.isWindows()) {
        try {
          Thread.sleep(2000);
        }
 catch (        InterruptedException e) {
          e.printStackTrace();
        }
      }
      Base.removeDir(newContribFolder);
    }
 else {
      status.setErrorMessage("Error overwriting .properties file.");
    }
  }
  if (tempFolder.exists()) {
    Base.removeDir(tempFolder);
  }
  return installedContrib;
}
