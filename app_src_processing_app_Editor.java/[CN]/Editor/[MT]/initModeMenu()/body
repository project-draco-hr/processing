{
  modeMenu=new JMenu();
  ButtonGroup modeGroup=new ButtonGroup();
  for (  final Mode m : base.getModeList()) {
    JRadioButtonMenuItem item=new JRadioButtonMenuItem(m.getTitle());
    item.addActionListener(new ActionListener(){
      public void actionPerformed(      ActionEvent e){
        base.changeMode(m);
        if (sketch.isModified()) {
          for (          Component c : modeMenu.getPopupMenu().getComponents()) {
            if (c instanceof JRadioButtonMenuItem) {
              if (((JRadioButtonMenuItem)c).getText() == mode.getTitle()) {
                ((JRadioButtonMenuItem)c).setSelected(true);
                break;
              }
            }
          }
        }
      }
    }
);
    modeMenu.add(item);
    modeGroup.add(item);
    if (mode == m) {
      item.setSelected(true);
    }
  }
  modeMenu.addSeparator();
  JMenuItem addLib=new JMenuItem("Add Mode...");
  addLib.addActionListener(new ActionListener(){
    public void actionPerformed(    ActionEvent e){
      base.handleOpenModeManager();
    }
  }
);
  modeMenu.add(addLib);
}
