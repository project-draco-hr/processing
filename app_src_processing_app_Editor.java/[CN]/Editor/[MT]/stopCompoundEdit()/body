{
  if (compoundEdit != null) {
    compoundEdit.end();
    undo.addEdit(compoundEdit);
    caretUndoStack.push(textarea.getCaretPosition());
    caretRedoStack.clear();
    undoAction.updateUndoState();
    redoAction.updateRedoState();
    compoundEdit=null;
  }
}
