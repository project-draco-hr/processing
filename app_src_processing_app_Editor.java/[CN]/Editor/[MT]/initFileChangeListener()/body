{
  try {
    WatchService watchService=FileSystems.getDefault().newWatchService();
    Path folderPath=sketch.getFolder().toPath();
    watcherKey=folderPath.register(watchService,StandardWatchEventKinds.ENTRY_MODIFY);
  }
 catch (  IOException e) {
    e.printStackTrace();
  }
  final WatchKey finKey=watcherKey;
  if (finKey != null) {
    addWindowFocusListener(new WindowFocusListener(){
      @Override public void windowGainedFocus(      WindowEvent arg0){
        if (finKey.isValid()) {
          List<WatchEvent<?>> events=finKey.pollEvents();
          processFileEvents(events);
        }
      }
      @Override public void windowLostFocus(      WindowEvent arg0){
        if (key != finKey) {
          return;
        }
        List<WatchEvent<?>> events=finKey.pollEvents();
        if (!watcherSave) {
          processFileEvents(events);
        }
        watcherSave=false;
      }
    }
);
  }
}
