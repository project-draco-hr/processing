{
  super("Processing");
  this.base=base;
  this.mode=mode;
  Base.setIcon(this);
  addWindowListener(new WindowAdapter(){
    public void windowClosing(    WindowEvent e){
      base.handleClose(Editor.this);
    }
  }
);
  setDefaultCloseOperation(JFrame.DO_NOTHING_ON_CLOSE);
  addWindowListener(new WindowAdapter(){
    public void windowActivated(    WindowEvent e){
      base.handleActivated(Editor.this);
      fileMenu.insert(base.getSketchbookMenu(),2);
      sketchMenu.insert(mode.getImportMenu(),4);
    }
    public void windowDeactivated(    WindowEvent e){
      fileMenu.remove(base.getSketchbookMenu());
      sketchMenu.remove(mode.getImportMenu());
    }
  }
);
  buildMenuBar();
  Container contentPain=getContentPane();
  contentPain.setLayout(new BorderLayout());
  JPanel pain=new JPanel();
  pain.setLayout(new BorderLayout());
  contentPain.add(pain,BorderLayout.CENTER);
  Box box=Box.createVerticalBox();
  Box upper=Box.createVerticalBox();
  initModeMenu();
  toolbar=createToolbar();
  upper.add(toolbar);
  header=new EditorHeader(this);
  upper.add(header);
  textarea=new JEditTextArea(new PdeTextAreaDefaults(mode));
  textarea.setRightClickPopup(new TextAreaPopup());
  textarea.setHorizontalOffset(JEditTextArea.leftHandGutter);
  consolePanel=new JPanel();
  consolePanel.setLayout(new BorderLayout());
  status=new EditorStatus(this);
  consolePanel.add(status,BorderLayout.NORTH);
  console=new EditorConsole(this);
  console.setBorder(null);
  consolePanel.add(console,BorderLayout.CENTER);
  lineStatus=new EditorLineStatus(this);
  consolePanel.add(lineStatus,BorderLayout.SOUTH);
  upper.add(textarea);
  splitPane=new JSplitPane(JSplitPane.VERTICAL_SPLIT,upper,consolePanel);
  splitPane.setOneTouchExpandable(true);
  splitPane.setContinuousLayout(true);
  splitPane.setResizeWeight(1D);
  splitPane.setBorder(null);
  int dividerSize=Preferences.getInteger("editor.divider.size");
  if (dividerSize != 0) {
    splitPane.setDividerSize(dividerSize);
  }
  box.add(splitPane);
  pain.add(box);
  textarea.addKeyListener(toolbar);
  pain.setTransferHandler(new FileDropHandler());
  pack();
  setPlacement(location);
  setMinimumSize(new Dimension(Preferences.getInteger("editor.window.width.min"),Preferences.getInteger("editor.window.height.min")));
  applyPreferences();
  boolean loaded=handleOpenInternal(path);
  if (!loaded)   sketch=null;
}
