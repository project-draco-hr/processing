{
  findRemoveDirectives(true);
  StringBuffer buffer=new StringBuffer();
  String head="", toe="; \n";
  if (crispBox.isSelected())   buffer.append(head + "crisp=true" + toe);
  if (!fontField.getText().trim().equals(""))   buffer.append(head + "font=\"" + fontField.getText().trim()+ "\""+ toe);
  if (globalKeyEventsBox.isSelected())   buffer.append(head + "globalKeyEvents=true" + toe);
  if (pauseOnBlurBox.isSelected())   buffer.append(head + "pauseOnBlur=true" + toe);
  if (!preloadField.getText().trim().equals(""))   buffer.append(head + "preload=\"" + preloadField.getText().trim()+ "\""+ toe);
  if (transparentBox.isSelected())   buffer.append(head + "transparent=true" + toe);
  Sketch sketch=editor.getSketch();
  SketchCode code=sketch.getCode(0);
  if (buffer.length() > 0) {
    code.setProgram("/* @pjs " + buffer.toString() + " */\n\n"+ code.getProgram());
    if (sketch.getCurrentCode() == code) {
      editor.setText(sketch.getCurrentCode().getProgram());
      editor.setSelection(0,0);
    }
    sketch.setModified(false);
    sketch.setModified(true);
  }
}
