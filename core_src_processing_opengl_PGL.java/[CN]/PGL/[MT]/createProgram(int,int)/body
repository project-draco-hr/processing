{
  int program=createProgram();
  if (program != 0) {
    if (intBuffer == null) {
      intBuffer=allocateDirectIntBuffer(1);
    }
    attachShader(program,vertexShader);
    attachShader(program,fragmentShader);
    linkProgram(program);
    getProgramiv(program,LINK_STATUS,intBuffer);
    boolean linked=intBuffer.get(0) == 0 ? false : true;
    if (!linked) {
      System.err.println("Could not link program: ");
      System.err.println(getProgramInfoLog(program));
      deleteProgram(program);
      program=0;
    }
  }
  return program;
}
