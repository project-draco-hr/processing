{
  PGraphicsOpenGL g=graphics.get();
  if (g == null)   return;
  boolean multisampled=isMultisampled() || g.offscreenMultisample;
  boolean depthReadingEnabled=g.getHint(PConstants.ENABLE_BUFFER_READING);
  boolean depthRequested=format == STENCIL_INDEX || format == DEPTH_COMPONENT || format == DEPTH_STENCIL;
  if (multisampled && depthRequested && !depthReadingEnabled) {
    PGraphics.showWarning(DEPTH_READING_NOT_ENABLED_ERROR);
    return;
  }
  g.beginReadPixels();
  readPixelsImpl(x,y,width,height,format,type,buffer);
  g.endReadPixels();
}
