{
  if (latch == null || latch.getCount() == 0)   return;
  drawable=glDrawable;
  context=glDrawable.getContext();
  glThread=Thread.currentThread();
  gl=context.getGL();
  gl2=gl.getGL2ES2();
  try {
    gl2x=gl.getGL2();
  }
 catch (  javax.media.opengl.GLException e) {
    gl2x=null;
  }
  if (USE_JOGL_FBOLAYER && capabilities.isFBO()) {
    GLFBODrawable fboDrawable=null;
    if (WINDOW_TOOLKIT == AWT) {
      GLCanvas glCanvas=(GLCanvas)glDrawable;
      fboDrawable=(GLFBODrawable)glCanvas.getDelegatedDrawable();
    }
 else {
      GLWindow glWindow=(GLWindow)glDrawable;
      fboDrawable=(GLFBODrawable)glWindow.getDelegatedDrawable();
    }
    if (fboDrawable != null) {
      backFBO=fboDrawable.getFBObject(GL.GL_BACK);
      if (0 < capabilities.getNumSamples()) {
        if (needSepFrontTex) {
          if (frontFBO == null) {
            System.out.println("init");
            frontFBO=new FBObject();
            frontFBO.reset(gl,pg.width,pg.height);
            frontFBO.attachTexture2D(gl,0,true);
            sinkFBO=backFBO.getSamplingSinkFBO();
            changedFrontTex=changedBackTex=true;
          }
 else {
            System.out.println("swap");
            FBObject temp=sinkFBO;
            sinkFBO=frontFBO;
            frontFBO=temp;
            backFBO.setSamplingSink(sinkFBO);
            changedFrontTex=changedBackTex=false;
          }
          backTexAttach=(FBObject.TextureAttachment)sinkFBO.getColorbuffer(0);
          frontTexAttach=(FBObject.TextureAttachment)frontFBO.getColorbuffer(0);
        }
 else {
          sinkFBO=backFBO.getSamplingSinkFBO();
          backTexAttach=(FBObject.TextureAttachment)sinkFBO.getColorbuffer(0);
          frontTexAttach=backTexAttach;
        }
      }
 else {
        frontFBO=fboDrawable.getFBObject(GL.GL_FRONT);
        backTexAttach=fboDrawable.getTextureBuffer(GL.GL_BACK);
        frontTexAttach=fboDrawable.getTextureBuffer(GL.GL_FRONT);
      }
    }
  }
  pg.parent.handleDraw();
  if (latch != null) {
    latch.countDown();
  }
}
