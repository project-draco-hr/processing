{
  if ((pixels == null) || (pixels.length != width * height)) {
    pixels=new int[width * height];
  }
  WritableRaster raster=((BufferedImage)image).getRaster();
  raster.getDataElements(0,0,width,height,pixels);
}
