{
  int lineHeight=fm.getHeight();
  int linesPerPage=(int)(pageFormat.getImageableHeight() / lineHeight);
  int lineCount=textArea.getLineCount();
  int lastPage=lineCount / linesPerPage;
  if (pageIndex > lastPage) {
    return NO_SUCH_PAGE;
  }
 else {
    Graphics2D g2d=(Graphics2D)g;
    TokenMarker tokenMarker=textArea.getDocument().getTokenMarker();
    int firstLine=pageIndex * linesPerPage;
    g2d.translate(pageFormat.getImageableX(),pageFormat.getImageableY() - firstLine * lineHeight);
    printing=true;
    for (int line=firstLine; line < firstLine + linesPerPage; line++) {
      paintLine(g2d,tokenMarker,line,0);
    }
    printing=false;
    return PAGE_EXISTS;
  }
}
