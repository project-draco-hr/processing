{
  report("top endDraw()");
  if (!drawing) {
    return;
  }
  flush();
  if (PGL.SAVE_SURFACE_TO_PIXELS_HACK && (!getPrimaryPG().initialized || parent.frameCount == 0)) {
    saveSurfaceToPixels();
    restoreSurface=true;
  }
  if (primaryGraphics) {
    endOnscreenDraw();
  }
 else {
    endOffscreenDraw();
  }
  if (primaryGraphics) {
    setCurrentPG(null);
  }
 else {
    getPrimaryPG().setCurrentPG(getPrimaryPG());
  }
  drawing=false;
  report("bot endDraw()");
}
