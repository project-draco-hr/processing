{
  if (fbStackDepth == 0) {
    throw new RuntimeException("popFramebuffer call is unbalanced.");
  }
  fbStackDepth--;
  FrameBuffer fbo=fbStack[fbStackDepth];
  if (currentFramebuffer != fbo) {
    currentFramebuffer.finish(pgPrimary);
    currentFramebuffer=fbo;
    currentFramebuffer.bind();
  }
}
