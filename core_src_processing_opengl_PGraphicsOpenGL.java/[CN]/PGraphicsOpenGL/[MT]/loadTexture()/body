{
  boolean needEndDraw=false;
  if (!drawing) {
    beginDraw();
    needEndDraw=true;
  }
  flush();
  if (primarySurface) {
    loadTextureImpl(Texture.POINT,false);
    if (pgl.isFBOBacked()) {
      pgl.forceUpdate();
      texture.set(pgl.getBackTexTarget(),pgl.getBackTexName(),pgl.getBackTexWidth(),pgl.getBackTexHeight(),width,height);
    }
 else {
      if (nativePixels == null || nativePixels.length < width * height) {
        nativePixels=new int[width * height];
        nativePixelBuffer=IntBuffer.wrap(nativePixels);
      }
      beginPixelsOp(OP_READ);
      pgl.readPixels(0,0,width,height,PGL.RGBA,PGL.UNSIGNED_BYTE,nativePixelBuffer);
      endPixelsOp();
      texture.setNative(nativePixels,0,0,width,height);
    }
  }
 else {
    if (offscreenMultisample) {
      offscreenFramebufferMultisample.copy(offscreenFramebuffer);
    }
  }
  if (needEndDraw) {
    endDraw();
  }
}
