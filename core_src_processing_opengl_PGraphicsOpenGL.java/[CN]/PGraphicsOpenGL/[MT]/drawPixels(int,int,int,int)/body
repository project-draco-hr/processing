{
  int i0=y * width + x;
  int len=w * h;
  if (nativePixels == null || nativePixels.length != len) {
    nativePixels=new int[len];
    nativePixelBuffer=IntBuffer.wrap(nativePixels);
  }
  PApplet.arrayCopy(pixels,i0,nativePixels,0,len);
  PGL.javaToNativeARGB(nativePixels,w,h);
  if (primarySurface && !pgl.isFBOBacked()) {
    loadTextureImpl(POINT,false);
  }
  pgl.copyToTexture(texture.glTarget,texture.glFormat,texture.glName,x,y,w,h,IntBuffer.wrap(nativePixels));
  boolean needToDrawTex=primarySurface && (!pgl.isFBOBacked() || (pgl.isFBOBacked() && pgl.isMultisampled())) || offscreenMultisample;
  if (needToDrawTex) {
    beginPixelsOp(OP_WRITE);
    drawTexture(x,y,w,h);
    endPixelsOp();
  }
}
