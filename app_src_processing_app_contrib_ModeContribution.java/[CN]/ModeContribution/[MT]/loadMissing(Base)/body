{
  File modesFolder=Base.getSketchbookModesFolder();
  List<ModeContribution> contribModes=base.getModeContribs();
  Map<File,ModeContribution> existing=new HashMap<File,ModeContribution>();
  for (  ModeContribution contrib : contribModes) {
    existing.put(contrib.getFolder(),contrib);
  }
  File[] potential=ContributionType.MODE.listCandidates(modesFolder);
  if (potential != null) {
    for (    File folder : potential) {
      if (!existing.containsKey(folder)) {
        try {
          contribModes.add(new ModeContribution(base,folder,null));
        }
 catch (        NoSuchMethodError nsme) {
          System.err.println(folder.getName() + " is not compatible with this version of Processing");
        }
catch (        NoClassDefFoundError ncdfe) {
          System.err.println(folder.getName() + " is not compatible with this version of Processing");
        }
catch (        InvocationTargetException ite) {
          System.err.println(folder.getName() + " could not be loaded and may not compatible with this version of Processing");
        }
catch (        IgnorableException ig) {
          Messages.log(ig.getMessage());
        }
catch (        Throwable e) {
          e.printStackTrace();
        }
      }
    }
  }
  final String useMode=System.getProperty("usemode");
  if (useMode != null) {
    final String[] modeInfo=useMode.split(":",2);
    final String modeClass=modeInfo[0];
    final String modeResourcePath=modeInfo[1];
    System.out.println("Attempting to load " + modeClass + " with resources at "+ modeResourcePath);
    contribModes.add(ModeContribution.load(base,new File(modeResourcePath),modeClass));
  }
}
