{
  this.textarea=(TextArea)textarea;
  editor=dedit;
  this.insertionPosition=position;
  if (subWord.indexOf('.') != -1)   this.subWord=subWord.substring(subWord.lastIndexOf('.') + 1);
 else   this.subWord=subWord;
  popupMenu=new JPopupMenu();
  popupMenu.removeAll();
  popupMenu.setOpaque(false);
  popupMenu.setBorder(null);
  scrollPane=new JScrollPane();
  if (UIManager.getLookAndFeel().getID().equals("Nimbus")) {
    UIDefaults defaults=new UIDefaults();
    defaults.put("PopupMenu.contentMargins",new InsetsUIResource(0,0,0,0));
    defaults.put("ScrollPane[Enabled].borderPainter",new Painter<JComponent>(){
      public void paint(      Graphics2D g,      JComponent t,      int w,      int h){
      }
    }
);
    popupMenu.putClientProperty("Nimbus.Overrides",defaults);
    scrollPane.putClientProperty("Nimbus.Overrides",defaults);
    scrollPane.getHorizontalScrollBar().setPreferredSize(new Dimension(Integer.MAX_VALUE,8));
    scrollPane.getVerticalScrollBar().setPreferredSize(new Dimension(8,Integer.MAX_VALUE));
    scrollPane.getHorizontalScrollBar().setUI(new CompletionScrollBarUI());
    scrollPane.getVerticalScrollBar().setUI(new CompletionScrollBarUI());
  }
  scrollPane.setViewportView(completionList=createSuggestionList(position,items));
  popupMenu.add(scrollPane,BorderLayout.CENTER);
  popupMenu.setPopupSize(calcWidth(),setHeight(items.getSize()));
  this.textarea.errorCheckerService.getASTGenerator().updateJavaDoc((CompletionCandidate)completionList.getSelectedValue());
  textarea.requestFocusInWindow();
  popupMenu.show(textarea,location.x,textarea.getBaseline(0,0) + location.y);
}
