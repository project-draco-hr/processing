{
  this.subWord=new String(newSubword);
  if (subWord.indexOf('.') != -1)   this.subWord=subWord.substring(subWord.lastIndexOf('.') + 1);
  insertionPosition=position;
  SwingUtilities.invokeLater(new Runnable(){
    @Override public void run(){
      scrollPane.getViewport().removeAll();
      completionList.setModel(items);
      completionList.setSelectedIndex(0);
      scrollPane.setViewportView(completionList);
      popupMenu.setPopupSize(calcWidth(),calcHeight(items.getSize()));
      textarea.requestFocusInWindow();
      popupMenu.show(textarea,location.x,textarea.getBaseline(0,0) + location.y);
      completionList.validate();
      scrollPane.validate();
      popupMenu.validate();
    }
  }
);
  return true;
}
