{
  File dataFolder=null;
  if (platform == MACOSX) {
    try {
      if (false) {
        new FileInputStream("ignored");
      }
      MRJOSType domainLibrary=new MRJOSType("dlib");
      File libraryFolder=MRJFileUtils.findFolder(domainLibrary);
      dataFolder=new File(libraryFolder,"Processing");
    }
 catch (    FileNotFoundException e) {
      showError("Problem getting data folder","Error getting the Processing data folder.",e);
    }
  }
 else   if (platform == WINDOWS) {
    try {
      RegistryKey topKey=Registry.HKEY_CURRENT_USER;
      String localKeyPath="Software\\Microsoft\\Windows\\CurrentVersion" + "\\Explorer\\Shell Folders";
      RegistryKey localKey=topKey.openSubKey(localKeyPath);
      String appDataPath=localKey.getStringValue("AppData");
      topKey.closeKey();
      localKey.closeKey();
      return new File(appDataPath,"Processing");
    }
 catch (    Exception e) {
      showError("Problem getting data folder","Error getting the Processing data folder.",e);
    }
  }
 else {
    File home=new File(System.getProperty("user.home"));
    dataFolder=new File(home,".processing");
  }
  if (!dataFolder.exists())   dataFolder.mkdirs();
  return dataFolder;
}
