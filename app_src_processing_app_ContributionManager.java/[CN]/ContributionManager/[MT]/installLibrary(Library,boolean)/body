{
  ArrayList<Library> oldLibs=editor.getMode().contribLibraries;
  String libFolderName=newLib.getFolder().getName();
  File libraryDestination=editor.getBase().getSketchbookLibrariesFolder();
  File newLibDest=new File(libraryDestination,libFolderName);
  boolean doInstall=true;
  for (  Library oldLib : oldLibs) {
    if (oldLib.getFolder().exists() && oldLib.getFolder().equals(newLibDest)) {
      int result=0;
      if (confirmReplace) {
        result=Base.showYesNoQuestion(editor,"Replace","Replace existing \"" + oldLib.getName() + "\" library?","An existing copy of the \"" + oldLib.getName() + "\" library<br>"+ "has been found in your sketchbook. Clicking ???????Yes???????<br>"+ "will move the existing library to a backup folder<br>"+ " in <i>libraries/old</i> before replacing it.");
      }
      if (!confirmReplace || result == JOptionPane.YES_OPTION) {
        if (!backupContribution(oldLib,true)) {
          return null;
        }
      }
 else {
        doInstall=false;
      }
    }
  }
  if (doInstall) {
    if (newLib.getFolder().renameTo(newLibDest)) {
      return new Library(newLibDest,null);
    }
 else {
      statusBar.setErrorMessage("Could not move library \"" + newLib.getName() + "\" to sketchbook.");
    }
  }
  return null;
}
