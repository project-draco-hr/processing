{
  File tempDir=unzipFileToTemp(zippedToolFile,statusBar);
  ArrayList<File> toolFolders=ToolContribution.discover(tempDir);
  if (toolFolders.isEmpty()) {
    toolFolders=ToolContribution.discover(tempDir.getParentFile());
  }
  if (toolFolders != null && toolFolders.size() == 1) {
    File toolFolder=toolFolders.get(0);
    final ToolContribution tool=ToolContribution.getTool(toolFolder);
    File propFile=new File(tool.getFolder(),"tool.properties");
    if (ad == null || writePropertiesFile(propFile,ad)) {
      return installTool(editor,tool,statusBar);
    }
 else {
      statusBar.setErrorMessage(ERROR_OVERWRITING_PROPERTIES_MESSAGE);
    }
  }
 else {
    if (toolFolders == null || toolFolders.isEmpty()) {
      statusBar.setErrorMessage(DISCOVERY_INTERNAL_ERROR_MESSAGE);
    }
 else {
      statusBar.setErrorMessage("There were multiple tools in the file, so we're ignoring it.");
    }
  }
  return null;
}
